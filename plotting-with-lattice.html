<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Lee On Coding, My blog about coding and stuff.">

        <link rel="alternate"  href="https://leemendelowitz.github.io/blog/feeds/all.atom.xml" type="application/atom+xml" title="Lee On Coding Full Atom Feed"/>

        <title>Plotting with Lattice // Lee On Coding // My blog about coding and stuff.</title>


    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.3.0/pure-min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://leemendelowitz.github.io/blog/theme/css/pure.css">
    <link rel="stylesheet" href="https://leemendelowitz.github.io/blog/theme/css/pygments.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js"></script>
    <script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script>
</head>

<body>
    <div class="pure-g-r" id="layout">
        <div class="sidebar pure-u">
            <div class="cover-img" style="background-image: url('https://leemendelowitz.github.io/blog/images/ss3.psd.png')">
                <div class="cover-body">
                    <header class="header">
                        <hgroup>
                            <img class="avatar" src="https://leemendelowitz.github.io/blog/images/twitter_img.png">
                            <h1 class="brand-main"><a href="/">Lee On Coding</a></h1>
                            <p class="tagline">My blog about coding and stuff.</p>
                                <p class="social">
                                    <a href="http://twitter.com/lmendy7">
                                        <i class="fa fa-twitter fa-3x"></i>
                                    </a>
                                    <a href="https://github.com/LeeMendelowitz">
                                        <i class="fa fa-github fa-3x"></i>
                                    </a>
                                <p>
                        </hgroup>
                    </header>
                </div>
            </div>
        </div>
    <div class="pure-u">
        <div class="content">
            <section class="post">
                <header class="post-header">
                    <h1>Plotting with Lattice</h1>
                        <p class="post-meta">
                            // under                                 <a class="post-category" href="https://leemendelowitz.github.io/blog/tag/r.html">R</a>
                                <a class="post-category" href="https://leemendelowitz.github.io/blog/tag/computing-for-data-analysis.html">Computing For Data Analysis</a>
                        </p>
                </header>
            </section>
            <p><a href="https://leemendelowitz.github.io/blog/computing_for_data_analysis/rmarkdown/lattice_demo.rmd">Download as R Markdown</a>.</p>
<p>The lattice library is useful for quickly making plots of multivariate data. It's easy to make plots which condition on one or more variables.</p>
<h3>Load the lattice library</h3>
<div class="highlight"><pre>library<span class="p">(</span>lattice<span class="p">)</span>

<span class="c1"># Ask for general information about the lattice package</span>
<span class="sb">`?`</span><span class="p">(</span>package<span class="p">,</span> lattice<span class="p">)</span>

<span class="c1"># See what is inside of the lattice package. It includes some datasets.</span>
library<span class="p">(</span>help <span class="o">=</span> lattice<span class="p">)</span>

<span class="c1"># Load the New York City environmental dataset.</span>
data<span class="p">(</span>environmental<span class="p">)</span>
<span class="sb">`?`</span><span class="p">(</span>environmental<span class="p">)</span>
head<span class="p">(</span>environmental<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span class="c">##   ozone radiation temperature wind</span>
<span class="c">## 1    41       190          67  7.4</span>
<span class="c">## 2    36       118          72  8.0</span>
<span class="c">## 3    12       149          74 12.6</span>
<span class="c">## 4    18       313          62 11.5</span>
<span class="c">## 5    23       299          65  8.6</span>
<span class="c">## 6    19        99          59 13.8</span>
</pre></div>


<h3>Plot ozone vs. radiation using xyplot</h3>
<div class="highlight"><pre>xyplot<span class="p">(</span>ozone <span class="o">~</span> radiation<span class="p">,</span> data <span class="o">=</span> environmental<span class="p">,</span> main <span class="o">=</span> <span class="s">&quot;Ozone vs. Radiation&quot;</span><span class="p">)</span>
</pre></div>


<p><img alt="plot of chunk section1" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section1.png" /> </p>
<h3>Investigate the relationship between ozone and radiation change as temperature changes</h3>
<p>To address this, break temperature into 4 overlapping ranges using the <code>equal.count</code> function.</p>
<div class="highlight"><pre>summary<span class="p">(</span>environmental<span class="o">$</span>temperature<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span class="c">##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="c">##    57.0    71.0    79.0    77.8    84.5    97.0</span>
</pre></div>


<div class="highlight"><pre><span class="c1"># Cut the temperature variable into four different ranges.</span>
temp.cut <span class="o">&lt;-</span> equal.count<span class="p">(</span>environmental<span class="o">$</span>temperature<span class="p">,</span> <span class="m">4</span><span class="p">)</span>
temp.cut
</pre></div>


<div class="highlight"><pre><span class="c">## </span>
<span class="c">## Data:</span>
<span class="c">##   [1] 67 72 74 62 65 59 61 69 66 68 58 64 66 57 68 62 59 73 61 61 67 81 79</span>
<span class="c">##  [24] 76 82 90 87 82 77 72 65 73 76 84 85 81 83 83 88 92 92 89 73 81 80 81</span>
<span class="c">##  [47] 82 84 87 85 74 86 85 82 86 88 86 83 81 81 81 82 89 90 90 86 82 80 77</span>
<span class="c">##  [70] 79 76 78 78 77 72 79 81 86 97 94 96 94 91 92 93 93 87 84 80 78 75 73</span>
<span class="c">##  [93] 81 76 77 71 71 78 67 76 68 82 64 71 81 69 63 70 75 76 68</span>
<span class="c">## </span>
<span class="c">## Intervals:</span>
<span class="c">##    min  max count</span>
<span class="c">## 1 56.5 76.5    46</span>
<span class="c">## 2 67.5 81.5    51</span>
<span class="c">## 3 75.5 86.5    51</span>
<span class="c">## 4 80.5 97.5    51</span>
<span class="c">## </span>
<span class="c">## Overlap between adjacent intervals:</span>
<span class="c">## [1] 27 30 31</span>
</pre></div>


<div class="highlight"><pre><span class="c1"># Default layout. This orders panel from left to right, bottom to top.</span>
xyplot<span class="p">(</span>ozone <span class="o">~</span> radiation <span class="o">|</span> temp.cut<span class="p">,</span> data <span class="o">=</span> environmental<span class="p">)</span>
</pre></div>


<p><img alt="plot of chunk section2a" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section2a1.png" /> </p>
<div class="highlight"><pre><span class="c1"># One column layout.</span>
xyplot<span class="p">(</span>ozone <span class="o">~</span> radiation <span class="o">|</span> temp.cut<span class="p">,</span> data <span class="o">=</span> environmental<span class="p">,</span> layout <span class="o">=</span> c<span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">4</span><span class="p">))</span>
</pre></div>


<p><img alt="plot of chunk section2a" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section2a2.png" /> </p>
<p>Use the <code>as.table</code> argument to draw panels in order from left to right, top to bottom.</p>
<div class="highlight"><pre><span class="c1"># One column, in ascending order of temperature range.</span>
xyplot<span class="p">(</span>ozone <span class="o">~</span> radiation <span class="o">|</span> temp.cut<span class="p">,</span> data <span class="o">=</span> environmental<span class="p">,</span> as.table <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>


<p><img alt="plot of chunk section2b" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section2b.png" /> </p>
<h3>Add a fit to each panel.</h3>
<p>Add a fit to each panel using a custom panel function. Note the use of <code>...</code> which allows for the <code>xyplot</code> parameters such as <code>pch</code> to be passed through the custom panel function.</p>
<div class="highlight"><pre>xyplot<span class="p">(</span>ozone <span class="o">~</span> radiation <span class="o">|</span> temp.cut<span class="p">,</span> data <span class="o">=</span> environmental<span class="p">,</span> layout <span class="o">=</span> c<span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">4</span><span class="p">),</span> 
    as.table <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> pch <span class="o">=</span> <span class="m">20</span><span class="p">,</span> panel <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">,</span> y<span class="p">,</span> <span class="kc">...</span><span class="p">)</span> <span class="p">{</span>
        panel.xyplot<span class="p">(</span>x<span class="p">,</span> y<span class="p">,</span> <span class="kc">...</span><span class="p">)</span>
        fit <span class="o">&lt;-</span> lm<span class="p">(</span>y <span class="o">~</span> x<span class="p">)</span>
        panel.abline<span class="p">(</span>fit<span class="p">,</span> lwd <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
    <span class="p">})</span>
</pre></div>


<p><img alt="plot of chunk section3" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section31.png" /> </p>
<div class="highlight"><pre>xyplot<span class="p">(</span>ozone <span class="o">~</span> radiation <span class="o">|</span> temp.cut<span class="p">,</span> data <span class="o">=</span> environmental<span class="p">,</span> as.table <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> 
    pch <span class="o">=</span> <span class="m">20</span><span class="p">,</span> panel <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">,</span> y<span class="p">,</span> <span class="kc">...</span><span class="p">)</span> <span class="p">{</span>
        panel.xyplot<span class="p">(</span>x<span class="p">,</span> y<span class="p">,</span> <span class="kc">...</span><span class="p">)</span>
        panel.loess<span class="p">(</span>x<span class="p">,</span> y<span class="p">,</span> lwd <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
    <span class="p">},</span> xlab <span class="o">=</span> <span class="s">&quot;Solar Radiation&quot;</span><span class="p">,</span> ylab <span class="o">=</span> <span class="s">&quot;Ozone (ppb)&quot;</span><span class="p">,</span> main <span class="o">=</span> <span class="s">&quot;Ozone vs. Solar Radiation&quot;</span><span class="p">)</span>
</pre></div>


<p><img alt="plot of chunk section3" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section32.png" /> </p>
<h3>Condition on both wind and temperature.</h3>
<div class="highlight"><pre>wind.cut <span class="o">&lt;-</span> equal.count<span class="p">(</span>environmental<span class="o">$</span>wind<span class="p">,</span> <span class="m">4</span><span class="p">)</span>
wind.cut
</pre></div>


<div class="highlight"><pre><span class="c">## </span>
<span class="c">## Data:</span>
<span class="c">##   [1]  7.4  8.0 12.6 11.5  8.6 13.8 20.1  9.7  9.2 10.9 13.2 11.5 12.0 18.4</span>
<span class="c">##  [15] 11.5  9.7  9.7 16.6  9.7 12.0 12.0 14.9  5.7  7.4  9.7 13.8 11.5  8.0</span>
<span class="c">##  [29] 14.9 20.7  9.2 11.5 10.3  4.0  9.2  9.2  4.6 10.9  5.1  6.3  5.7  7.4</span>
<span class="c">##  [43] 14.3 14.9 14.3  6.9 10.3  6.3  5.1 11.5  6.9  8.6  8.0  8.6 12.0  7.4</span>
<span class="c">##  [57]  7.4  7.4  9.2  6.9 13.8  7.4  4.0 10.3  8.0 11.5 11.5  9.7 10.3  6.3</span>
<span class="c">##  [71]  7.4 10.9 10.3 15.5 14.3  9.7  3.4  8.0  9.7  2.3  6.3  6.3  6.9  5.1</span>
<span class="c">##  [85]  2.8  4.6  7.4 15.5 10.9 10.3 10.9  9.7 14.9 15.5  6.3 10.9 11.5  6.9</span>
<span class="c">##  [99] 13.8 10.3 10.3  8.0 12.6  9.2 10.3 10.3 16.6  6.9 14.3  8.0 11.5</span>
<span class="c">## </span>
<span class="c">## Intervals:</span>
<span class="c">##     min   max count</span>
<span class="c">## 1  2.05  9.45    49</span>
<span class="c">## 2  6.65 10.55    50</span>
<span class="c">## 3  8.95 12.85    47</span>
<span class="c">## 4 10.05 20.95    53</span>
<span class="c">## </span>
<span class="c">## Overlap between adjacent intervals:</span>
<span class="c">## [1] 31 25 32</span>
</pre></div>


<div class="highlight"><pre>xyplot<span class="p">(</span>ozone <span class="o">~</span> radiation <span class="o">|</span> temp.cut <span class="o">*</span> wind.cut<span class="p">,</span> data <span class="o">=</span> environmental<span class="p">,</span> as.table <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> 
    pch <span class="o">=</span> <span class="m">20</span><span class="p">,</span> panel <span class="o">=</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">,</span> y<span class="p">,</span> <span class="kc">...</span><span class="p">)</span> <span class="p">{</span>
        panel.xyplot<span class="p">(</span>x<span class="p">,</span> y<span class="p">,</span> <span class="kc">...</span><span class="p">)</span>
        panel.loess<span class="p">(</span>x<span class="p">,</span> y<span class="p">)</span>
    <span class="p">},</span> xlab <span class="o">=</span> <span class="s">&quot;Solar Radiation&quot;</span><span class="p">,</span> ylab <span class="o">=</span> <span class="s">&quot;Ozone (ppb)&quot;</span><span class="p">,</span> main <span class="o">=</span> <span class="s">&quot;Ozone vs. Solar Radiation&quot;</span><span class="p">)</span>
</pre></div>


<p><img alt="plot of chunk section4" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section4.png" /> </p>
<h3>splom</h3>
<p>Use splom to draw conditional scatter plot matrices.</p>
<div class="highlight"><pre>splom<span class="p">(</span><span class="o">~</span>environmental<span class="p">)</span>
</pre></div>


<p><img alt="plot of chunk section5" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section5.png" /> </p>
<h3>histogram</h3>
<div class="highlight"><pre>histogram<span class="p">(</span><span class="o">~</span>temperature <span class="o">|</span> wind.cut<span class="p">,</span> data <span class="o">=</span> environmental<span class="p">,</span> as.table <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>


<p><img alt="plot of chunk section 6" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section_61.png" /> </p>
<div class="highlight"><pre>histogram<span class="p">(</span><span class="o">~</span>ozone <span class="o">|</span> wind.cut<span class="p">,</span> data <span class="o">=</span> environmental<span class="p">,</span> as.table <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>


<p><img alt="plot of chunk section 6" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section_62.png" /> </p>
<div class="highlight"><pre>histogram<span class="p">(</span><span class="o">~</span>ozone <span class="o">|</span> wind.cut <span class="o">*</span> temp.cut<span class="p">,</span> data <span class="o">=</span> environmental<span class="p">,</span> as.table <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</pre></div>


<p><img alt="plot of chunk section 6" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section_63.png" /> </p>
            <a href="#" class="go-top">Go Top</a>
    <div class="comments">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = "leeoncoding"; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
<footer class="footer">
    <p>&copy; Lee Mendelowitz &ndash;
        Built with <a href="https://github.com/PurePelicanTheme/pure-single">Pure Theme</a>
        for <a href="http://blog.getpelican.com/">Pelican</a>
    </p>
</footer>        </div>
    </div>
    </div>
    <script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script>
    <script type="text/javascript">
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
        try {
            var pageTracker = _gat._getTracker("UA-44545448-1");
            pageTracker._trackPageview();
            } catch(err) {}
    </script>

</body>
</html>