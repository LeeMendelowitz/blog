<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Lee On Coding</title><link href="https://leemendelowitz.github.io/blog/" rel="alternate"></link><link href="https://leemendelowitz.github.io/blog/feeds/lee-mendelowitz.atom.xml" rel="self"></link><id>https://leemendelowitz.github.io/blog/</id><updated>2015-03-04T17:30:00+01:00</updated><entry><title>How does python find packages?</title><link href="https://leemendelowitz.github.io/blog/how-does-python-find-packages.html" rel="alternate"></link><updated>2015-03-04T17:30:00+01:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2015-03-04:blog/how-does-python-find-packages.html</id><summary type="html">&lt;p&gt;I just ran into a situation where I compiled and installed Python 2.7.9 from source on Ubuntu, but Python could not find the packages I had previously installed. This naturally raises the question - how does Python know where to find packages when you call &lt;code&gt;import&lt;/code&gt;? This post applies specifically to Python 2.7.9, but I'm guessing Python 3x works very similarly.&lt;/p&gt;
&lt;p&gt;In this post I first describe how Python finds packages, and then I'll finish with the discovery I made regarding the default Python that ships with Ubuntu and how it differs from vanilla Python in how it finds packages.&lt;/p&gt;
&lt;h2&gt;&lt;code&gt;sys.path&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Python imports work by searching the directories listed in &lt;code&gt;sys.path&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;Using my default Ubuntu 14.04 Python:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&amp;gt; import sys
&amp;gt; print &lt;span class="s1"&gt;&amp;#39;\n&amp;#39;&lt;/span&gt;.join&lt;span class="o"&gt;(&lt;/span&gt;sys.path&lt;span class="o"&gt;)&lt;/span&gt;

/usr/lib/python2.7
/usr/lib/python2.7/plat-x86_64-linux-gnu
/usr/lib/python2.7/lib-tk
/usr/lib/python2.7/lib-old
/usr/lib/python2.7/lib-dynload
/usr/local/lib/python2.7/dist-packages
/usr/lib/python2.7/dist-packages
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So Python will find any packages that have been installed to those locations.&lt;/p&gt;
&lt;h3&gt;How sys.path gets populated&lt;/h3&gt;
&lt;p&gt;As the &lt;a href="https://docs.python.org/2/library/sys.html#sys.path"&gt;docs&lt;/a&gt; explain, &lt;code&gt;sys.path&lt;/code&gt; is populated using
the current working directory, followed by directories listed in your &lt;code&gt;PYTHONPATH&lt;/code&gt; environment variable,
followed by installation-dependent default paths, which are controlled by the &lt;code&gt;site&lt;/code&gt; module.&lt;/p&gt;
&lt;p&gt;You can read more about &lt;code&gt;sys.path&lt;/code&gt; in the &lt;a href="https://docs.python.org/2/library/sys.html#sys.path"&gt;Python docs&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Assuming your &lt;code&gt;PYTHONPATH&lt;/code&gt; environment variable is not set, &lt;code&gt;sys.path&lt;/code&gt; will consist of the current working directory plus
any manipulations made to it by the &lt;code&gt;site&lt;/code&gt; module.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;site&lt;/code&gt; module is automatically imported when you start Python, you can read more about how it manipulates your
&lt;code&gt;sys.path&lt;/code&gt; in the &lt;a href="https://docs.python.org/2/library/site.html#module-site"&gt;Python docs&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;It's a bit involved.&lt;/p&gt;
&lt;h3&gt;You can manipulate &lt;code&gt;sys.path&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;You can manipulate &lt;code&gt;sys.path&lt;/code&gt; during a Python session and this will change how Python finds modules. For example:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;

&lt;span class="c"&gt;# This won&amp;#39;t work - there is no hi module&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;hi&lt;/span&gt; 
&lt;span class="n"&gt;Traceback&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;most&lt;/span&gt; &lt;span class="n"&gt;recent&lt;/span&gt; &lt;span class="n"&gt;call&lt;/span&gt; &lt;span class="n"&gt;last&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="n"&gt;File&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;lt;stdin&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;module&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="ne"&gt;ImportError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;No&lt;/span&gt; &lt;span class="n"&gt;module&lt;/span&gt; &lt;span class="n"&gt;named&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;

&lt;span class="c"&gt;# Create a hi module in your home directory.&lt;/span&gt;
&lt;span class="n"&gt;home_dir&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;expanduser&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;~&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;my_module_file&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;home_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;hi.py&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;my_module_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;print &amp;quot;hi&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;a=10&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c"&gt;# Add the home directory to sys.path&lt;/span&gt;
&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;home_dir&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c"&gt;# Now this works, and prints hi!&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;hi&lt;/span&gt; 
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;The module &lt;code&gt;__file__&lt;/code&gt; attribute&lt;/h3&gt;
&lt;p&gt;When you import a module, you usually can check the &lt;code&gt;__file__&lt;/code&gt; attribute of the module to see where the module is in your filesystem:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__file__&lt;/span&gt;
&lt;span class="s"&gt;&amp;#39;/usr/local/lib/python2.7/dist-packages/numpy/__init__.pyc&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;However, the &lt;a href="https://docs.python.org/2/reference/datamodel.html#the-standard-type-hierarchy"&gt;Python docs&lt;/a&gt; state that:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The &lt;strong&gt;file&lt;/strong&gt; attribute is not present for C modules that are statically linked into the interpreter; for extension modules loaded dynamically from a shared library, it is the pathname of the shared library file.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So, for example this doesn't work:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__file__&lt;/span&gt;
&lt;span class="n"&gt;Traceback&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;most&lt;/span&gt; &lt;span class="n"&gt;recent&lt;/span&gt; &lt;span class="n"&gt;call&lt;/span&gt; &lt;span class="n"&gt;last&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="n"&gt;File&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;&amp;lt;stdin&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;module&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="ne"&gt;AttributeError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;module&amp;#39;&lt;/span&gt; &lt;span class="nb"&gt;object&lt;/span&gt; &lt;span class="n"&gt;has&lt;/span&gt; &lt;span class="n"&gt;no&lt;/span&gt; &lt;span class="n"&gt;attribute&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;__file__&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It makes sense that the &lt;code&gt;sys&lt;/code&gt; module is statically linked to the interpreter - it is essentially part of the interpreter!&lt;/p&gt;
&lt;h2&gt;The &lt;code&gt;imp&lt;/code&gt; module&lt;/h2&gt;
&lt;p&gt;Python exposes the entire &lt;code&gt;import&lt;/code&gt; system through the &lt;a href="https://docs.python.org/2.7/library/imp.html"&gt;&lt;code&gt;imp&lt;/code&gt; module&lt;/a&gt;. 
That's pretty cool that all of this stuff is exposed for us to abuse, if we wanted to.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;imp.find_module&lt;/code&gt; can be used to find a module:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;imp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find_module&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;numpy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;/usr/local/lib/python2.7/dist-packages/numpy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can also &lt;code&gt;import&lt;/code&gt; and arbitrary Python source as a module using &lt;code&gt;imp.load_source&lt;/code&gt;. This is the same example before,
except imports our module using &lt;code&gt;imp&lt;/code&gt; instead of by manipulating &lt;code&gt;sys.path&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;

&lt;span class="c"&gt;# Create a hi module in your home directory.&lt;/span&gt;
&lt;span class="n"&gt;home_dir&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;expanduser&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;~&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;my_module_file&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;home_dir&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;hi.py&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;my_module_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;print &amp;quot;hi&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;a=10&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c"&gt;# Load the hi module using imp&lt;/span&gt;
&lt;span class="n"&gt;hi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;imp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load_source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;hi&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;my_module_file&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c"&gt;# Now this works, and prints hi!&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;hi&lt;/span&gt; 
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="c"&gt;# a is 10!&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;hi&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;# it&amp;#39;s a module!&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Passing &lt;code&gt;'hi'&lt;/code&gt; to &lt;code&gt;imp.load_source&lt;/code&gt; simply sets the &lt;code&gt;__name__&lt;/code&gt; attribute of the module.&lt;/p&gt;
&lt;h2&gt;Ubuntu Python&lt;/h2&gt;
&lt;p&gt;Now back to the issue of missing packages after installing a new version of Python compiled from source. By comparing the 
&lt;code&gt;sys.path&lt;/code&gt; from both the Ubuntu Python, which resides at &lt;code&gt;/usr/bin/python&lt;/code&gt;, and the newly installed Python, which
resides at &lt;code&gt;/usr/local/bin/python&lt;/code&gt;, I could sort things out:&lt;/p&gt;
&lt;h3&gt;Ubuntu Python (&lt;code&gt;/usr/bin/python&lt;/code&gt;):&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&amp;gt;&amp;gt;&amp;gt; import sys
&amp;gt;&amp;gt;&amp;gt; print &lt;span class="s1"&gt;&amp;#39;\n&amp;#39;&lt;/span&gt;.join&lt;span class="o"&gt;(&lt;/span&gt;sys.path&lt;span class="o"&gt;)&lt;/span&gt;

/usr/lib/python2.7
/usr/lib/python2.7/plat-x86_64-linux-gnu
/usr/lib/python2.7/lib-tk
/usr/lib/python2.7/lib-old
/usr/lib/python2.7/lib-dynload
/usr/local/lib/python2.7/dist-packages
/usr/lib/python2.7/dist-packages
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Python compiled from source (&lt;code&gt;/usr/local/bin/python&lt;/code&gt;)&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&amp;gt;&amp;gt;&amp;gt; import sys
&amp;gt;&amp;gt;&amp;gt; print &lt;span class="s1"&gt;&amp;#39;\n&amp;#39;&lt;/span&gt;.join&lt;span class="o"&gt;(&lt;/span&gt;sys.path&lt;span class="o"&gt;)&lt;/span&gt;

/usr/local/lib/python2.7/dist-packages
/usr/local/lib/python27.zip
/usr/local/lib/python2.7
/usr/local/lib/python2.7/plat-linux2
/usr/local/lib/python2.7/lib-tk
/usr/local/lib/python2.7/lib-old
/usr/local/lib/python2.7/lib-dynload
/usr/local/lib/python2.7/site-packages
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Turns out what mattered for me was &lt;code&gt;dist-packages&lt;/code&gt; vs. &lt;code&gt;site-packages&lt;/code&gt;. Using Ubuntu's Python, my packges were installed to &lt;code&gt;/usr/local/lib/python2.7/dist-packages&lt;/code&gt;, whereas the new Python I installed expects packages to be installed to &lt;code&gt;/usr/local/lib/python2.7/site-packages&lt;/code&gt;. I just had to manipulate the &lt;code&gt;PYTHONPATH&lt;/code&gt; environment variable to point to &lt;code&gt;dist-packages&lt;/code&gt; in order to gain access to the previously installed packaged with the newly installed version of Python.&lt;/p&gt;
&lt;h4&gt;How did Ubuntu manipulate the &lt;code&gt;sys.path&lt;/code&gt;?&lt;/h4&gt;
&lt;p&gt;So how does the Ubuntu distribution of Python know to use &lt;code&gt;/usr/local/lib/python2.7/dist-packages&lt;/code&gt; in &lt;code&gt;sys.path&lt;/code&gt;? It's hardcoded
into their &lt;code&gt;site&lt;/code&gt; module! First, find where the &lt;code&gt;site&lt;/code&gt; module code lives:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;site&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;site&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__file__&lt;/span&gt;
&lt;span class="s"&gt;&amp;#39;/usr/lib/python2.7/site.pyc&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Here is an excerpt from Ubuntu Python's &lt;code&gt;site.py&lt;/code&gt;, which I peeked by opening &lt;code&gt;/usr/lib/python2.7/site.py&lt;/code&gt; in a text editor. First, a comment at the top:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;For Debian and derivatives, this sys.path is augmented with directories
for packages distributed within the distribution. Local addons go
into /usr/local/lib/python&lt;version&gt;/dist-packages, Debian addons
install into /usr/{lib,share}/python&lt;version&gt;/dist-packages.
/usr/lib/python&lt;version&gt;/site-packages is not used.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;OK so there you have it. They explain how the Debian distribution of Python is different.&lt;/p&gt;
&lt;p&gt;And now, for the code that implementes this change:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;getsitepackages&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Returns a list containing all global site-packages directories&lt;/span&gt;
&lt;span class="sd"&gt;    (and possibly site-python).&lt;/span&gt;

&lt;span class="sd"&gt;    For each directory present in the global ``PREFIXES``, this function&lt;/span&gt;
&lt;span class="sd"&gt;    will find its `site-packages` subdirectory depending on the system&lt;/span&gt;
&lt;span class="sd"&gt;    environment, and will return a list of full paths.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;sitepackages&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="n"&gt;seen&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;prefix&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;PREFIXES&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;prefix&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;prefix&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;seen&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;continue&lt;/span&gt;
        &lt;span class="n"&gt;seen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;platform&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;os2emx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;riscos&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;sitepackages&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Lib&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;site-packages&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sep&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;sitepackages&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;local/lib&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                                        &lt;span class="s"&gt;&amp;quot;python&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;version&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                                        &lt;span class="s"&gt;&amp;quot;dist-packages&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="n"&gt;sitepackages&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;lib&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                                        &lt;span class="s"&gt;&amp;quot;python&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;version&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                                        &lt;span class="s"&gt;&amp;quot;dist-packages&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;sitepackages&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;sitepackages&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;lib&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;site-packages&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;platform&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;darwin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="c"&gt;# for framework builds *only* we add the standard Apple&lt;/span&gt;
            &lt;span class="c"&gt;# locations.&lt;/span&gt;
            &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sysconfig&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;get_config_var&lt;/span&gt;
            &lt;span class="n"&gt;framework&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_config_var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;PYTHONFRAMEWORK&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;framework&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;sitepackages&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
                        &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/Library&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;framework&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;version&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;site-packages&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;sitepackages&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It's all there, if you are crazy enough to dig this deep.&lt;/p&gt;</summary><category term="Python"></category></entry><entry><title>Fix the pesky "^M" carriage return control character using tr</title><link href="https://leemendelowitz.github.io/blog/remove-carriage-return-control-character.html" rel="alternate"></link><updated>2015-02-04T03:20:00+01:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2015-02-04:blog/remove-carriage-return-control-character.html</id><summary type="html">&lt;p&gt;When working with Microsoft Excel 2011 on Mac OS X, it will export spreadsheets to comma separated .csv files or
tab delimited .txt plain text files using the old Mac OS 9 line endings of a carriage return (&lt;code&gt;\r&lt;/code&gt;).
When viewed with &lt;code&gt;less&lt;/code&gt; or &lt;code&gt;vi&lt;/code&gt;, these characters appear as &lt;code&gt;^M&lt;/code&gt;, and the text file appears as one massively long line.&lt;/p&gt;
&lt;p&gt;These end of line characters can be handled when importing data using R or Python's pandas library, but it's still a 
nuisance for other common Unix utilities like GNU's &lt;code&gt;head&lt;/code&gt;, &lt;code&gt;tail&lt;/code&gt;, &lt;code&gt;less&lt;/code&gt;, &lt;code&gt;wc -l&lt;/code&gt;, etc.&lt;/p&gt;
&lt;p&gt;There are a few ways to convert these line endings using GNU utilities. You can use &lt;code&gt;tr&lt;/code&gt; or &lt;code&gt;dos2unix&lt;/code&gt;. &lt;/p&gt;
&lt;h1&gt;Using tr&lt;/h1&gt;
&lt;h3&gt;Mac (&lt;code&gt;\r&lt;/code&gt;) to Unix (&lt;code&gt;\n&lt;/code&gt;)&lt;/h3&gt;
&lt;p&gt;To replace those &lt;code&gt;^M&lt;/code&gt;'s with Unix line endings, use the &lt;code&gt;tr&lt;/code&gt; utility:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;tr &lt;span class="s1"&gt;&amp;#39;\r&amp;#39;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;\n&amp;#39;&lt;/span&gt; &amp;lt; DC_Metrorail_Ridership.mac.csv &amp;gt; DC_Metrorail_Ridership.unix.csv
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This will replace all carriage returns with line feeds.&lt;/p&gt;
&lt;h3&gt;Windows (&lt;code&gt;\r\n&lt;/code&gt;) to Unix (&lt;code&gt;\n&lt;/code&gt;)&lt;/h3&gt;
&lt;p&gt;Windows line endings use carriage return followed by line feed, so to convert Microsoft text files line endings to Unix use the following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;tr -d &lt;span class="s1"&gt;&amp;#39;\r&amp;#39;&lt;/span&gt; &amp;lt; DC_Metrorail_Ridership.windows.csv &amp;gt; DC_Metrorail_Ridership.unix.csv
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;Using dos2unix or mac2unix&lt;/h1&gt;
&lt;p&gt;Another option is to use the &lt;code&gt;dos2unix&lt;/code&gt; utility. To install on Mac OS X using Homebrew:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;brew update
brew install dos2unix
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Mac (&lt;code&gt;\r&lt;/code&gt;) to Unix (&lt;code&gt;\n&lt;/code&gt;)&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;mac2unix -n DC_Metrorail_Ridership.mac.csv DC_Metrorail_Ridership.unix.csv
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Windows (&lt;code&gt;\r\n&lt;/code&gt;) to Unix (&lt;code&gt;\n&lt;/code&gt;)&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;dos2unix -n DC_Metrorail_Ridership.windows.csv DC_Metrorail_Ridership.unix.csv
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;I made a &lt;a href="https://gist.github.com/LeeMendelowitz/7509ae7cfeaf1072822a"&gt;GitHub gist&lt;/a&gt; where you can test all of this out. Clone the gist with:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;git clone https://gist.github.com/7509ae7cfeaf1072822a.git
&lt;/pre&gt;&lt;/div&gt;</summary></entry><entry><title>std::sort and std::bad_alloc</title><link href="https://leemendelowitz.github.io/blog/sort-bad-alloc.html" rel="alternate"></link><updated>2014-12-23T22:02:00+01:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2014-12-23:blog/sort-bad-alloc.html</id><summary type="html">&lt;p&gt;Sometimes programming in C++ is wonderful when everything works and programs run blazingly fast, and then there are those painful moments when you encounter hard to diagnose runtime errors.&lt;/p&gt;
&lt;p&gt;In this case, I was calling &lt;code&gt;std::sort&lt;/code&gt; to sort a &lt;code&gt;std::vector&lt;/code&gt; of &lt;code&gt;Alignment&lt;/code&gt; objects.
I was using my own custom compare class to determine when one &lt;code&gt;Alignment&lt;/code&gt; object should appear before the other.&lt;/p&gt;
&lt;p&gt;The sort failed by throwing a &lt;code&gt;std::bad_alloc&lt;/code&gt; exception, which is &lt;a href="http://www.cplusplus.com/reference/new/bad_alloc/"&gt;thrown when failing to allocate memory&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I was baffled for quite a while and had to step into the &lt;code&gt;gdb&lt;/code&gt; debugger to get a very long backtrace with all of the gory details.&lt;/p&gt;
&lt;p&gt;After quite some time, it boiled down to the fact that I had a bug in the &lt;code&gt;Alignment&lt;/code&gt;assignment operator: &lt;code&gt;Alignment&amp;amp; operator=(const Alignment&amp;amp; a)&lt;/code&gt;. This buggy assignment operator did not properly assign all of the attributes of the &lt;code&gt;Alignment&lt;/code&gt; object - in particular it failed to properly assign the attribute being sorted on (oops!) - and this had the effect of violating the strict weak ordering which &lt;code&gt;std::sort&lt;/code&gt; requires of the compare operator. This, in turn, somehow resulted in the &lt;code&gt;std::bad_alloc&lt;/code&gt; exception. &lt;/p&gt;
&lt;p&gt;It turns out I did not even need to provide a custom assignment operator - the default provided by the compiler would do.&lt;/p&gt;
&lt;p&gt;For future reference, here's a &lt;a href="http://stackoverflow.com/questions/9170080/stdsort-getting-a-stdbad-alloc"&gt;Stack Overflow&lt;/a&gt; post where someone else encountered the same thing.&lt;/p&gt;
&lt;p&gt;Like I said, C++ can be painful.&lt;/p&gt;</summary><category term="C++"></category></entry><entry><title>Installing Numpy with OpenBlas</title><link href="https://leemendelowitz.github.io/blog/installing-numpy-with-openblas.html" rel="alternate"></link><updated>2014-10-23T09:20:00+02:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2014-10-23:blog/installing-numpy-with-openblas.html</id><summary type="html">&lt;p&gt;I just went through the frustrating but in the end rewarding experience of trying to install numpy in my school computing RHEL5 environment where I don't have sudo privileges or much control over the environment. In the end, I learned quite a bit!&lt;/p&gt;
&lt;p&gt;My first attempt to install was through the normal path, where I activate a virtual environment created with &lt;code&gt;virtualenv&lt;/code&gt; and then use pip to install numpy:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; ~
virtualenv venv
&lt;span class="nb"&gt;source &lt;/span&gt;venv/bin/activate
pip install numpy
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;But trying to build numpy in my environment led to this error:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;ImportError&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="sr"&gt;/venv/lib/python2.7/site-packages/numpy/linalg/&lt;/span&gt;&lt;span class="n"&gt;lapack_lite&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;so&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;undefined&lt;/span&gt; &lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;zgelsd_&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So that's the clue - something is wrong with the lapack library numpy is trying to use from my environment. It's probably linked against something broken or something incompatible... or something missing.&lt;/p&gt;
&lt;p&gt;Here's what &lt;code&gt;ldd&lt;/code&gt; on the &lt;strong&gt;broken&lt;/strong&gt; lapack_lite.so gives:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;ldd home/venv/lib/python2.7/site-packages/numpy/linalg/lapack_lite.so
        linux-vdso.so.1 &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt;  &lt;span class="o"&gt;(&lt;/span&gt;0x00007fff08126000&lt;span class="o"&gt;)&lt;/span&gt;
        libpython2.7.so.1.0 &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; not found
        libpthread.so.0 &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; /lib64/libpthread.so.0 &lt;span class="o"&gt;(&lt;/span&gt;0x00002b39c2bc9000&lt;span class="o"&gt;)&lt;/span&gt;
        libc.so.6 &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; /lib64/libc.so.6 &lt;span class="o"&gt;(&lt;/span&gt;0x00002b39c2de5000&lt;span class="o"&gt;)&lt;/span&gt;
        /lib64/ld-linux-x86-64.so.2 &lt;span class="o"&gt;(&lt;/span&gt;0x0000003185e00000&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So, after some searching around, it seems like the best option was to compile the &lt;a href="https://github.com/xianyi/OpenBLAS"&gt;OpenBlas&lt;/a&gt; library and use that during the numpy build. I was able to salvage bits from &lt;a href="https://gist.github.com/sniderbr/5891950"&gt;this&lt;/a&gt;, and &lt;a href="http://gromgull.net/blog/2013/07/multithreaded-scipynumpy-with-openblas-on-debian/"&gt;this&lt;/a&gt; to get it to work.&lt;/p&gt;
&lt;h1&gt;Build OpenBlas&lt;/h1&gt;
&lt;p&gt;Untar the OpenBlas distribution &lt;a href="http://www.openblas.net/"&gt;available here&lt;/a&gt; and build using the makefile:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;make &lt;span class="nv"&gt;BINARY&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;64 &lt;span class="nv"&gt;FC&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;gfortran &lt;span class="nv"&gt;USE_THREAD&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;1
make &lt;span class="nv"&gt;PREFIX&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/path/to/openblas install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;where &lt;code&gt;/path/to/openblas&lt;/code&gt; is the path where you'd like to install openblas. Again, since I did have &lt;code&gt;sudo&lt;/code&gt; privilegs, I chose a non-standard location.&lt;/p&gt;
&lt;h1&gt;Build Numpy&lt;/h1&gt;
&lt;p&gt;We need to build numpy and link it with the OpenBlas library. I couldn't achieve this with the default &lt;code&gt;pip&lt;/code&gt; install, so things had to be done manually as suggested in &lt;a href="http://gromgull.net/blog/2013/07/multithreaded-scipynumpy-with-openblas-on-debian/"&gt;this post&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;source &lt;/span&gt;venv/bin/activate
pip uninstall numpy &lt;span class="c"&gt;# Uninstall the broken installation&lt;/span&gt;
mkdir venv/download
pip install -d venv/download numpy
mkdir venv/build
&lt;span class="nb"&gt;cd &lt;/span&gt;venv/build
tar xzf ../download/numpy-1.9.0.tar.gz
&lt;span class="nb"&gt;cd &lt;/span&gt;numpy-1.9.0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;In the &lt;code&gt;numpy-1.9.0&lt;/code&gt; directory, create the &lt;code&gt;site.cfg&lt;/code&gt; file to customize the libraries that numpy uses on install. We need to point things to OpenBlas. Check out the &lt;code&gt;site.cfg.example&lt;/code&gt; file for what options you can set. This worked for me:  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="o"&gt;[&lt;/span&gt;DEFAULT&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nv"&gt;library_dirs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; /path/to/openblas/lib
&lt;span class="nv"&gt;include_dirs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; /path/to/openblas/include

&lt;span class="o"&gt;[&lt;/span&gt;atlas&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nv"&gt;atlas_libs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; openblas
&lt;span class="nv"&gt;libraries&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; openblas

&lt;span class="o"&gt;[&lt;/span&gt;openblas&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nv"&gt;libraries&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; openblas
&lt;span class="nv"&gt;library_dirs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  /path/to/openblas/lib
&lt;span class="nv"&gt;include_dirs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  /path/to/openblas/include
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Next, build numpy &lt;strong&gt;being sure to specify the same fortran compiler that was used to build the OpenBlas library&lt;/strong&gt; (important point mentioned in the &lt;a href="http://docs.scipy.org/doc/numpy/user/install.html"&gt;scipy install docs&lt;/a&gt;). For good measure, I cleaned out all of the standard compile and linking flags from my environment to make sure I wasn't contaminating the build:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;unset &lt;/span&gt;CPPFLAGS
&lt;span class="nb"&gt;unset &lt;/span&gt;LDFLAGS
python setup.py build --fcompiler&lt;span class="o"&gt;=&lt;/span&gt;gnu95
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;When the build completes, install:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;python setup.py install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Since the virtual environment is active, this will install to the virtual environment.&lt;/p&gt;
&lt;p&gt;Finally, here's what &lt;code&gt;ldd&lt;/code&gt; on the working &lt;code&gt;lapack_lite.so&lt;/code&gt; library gives:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;ldd&lt;/span&gt; &lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;venv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;python2&lt;/span&gt;&lt;span class="mf"&gt;.7&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;site&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;packages&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linalg&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lapack_lite&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;venv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;bash&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3.2&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt; &lt;span class="n"&gt;ldd&lt;/span&gt; &lt;span class="n"&gt;lapack_lite&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;
        &lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;vdso&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.1&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;  &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x00007ffff40b9000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;libopenblas&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.0&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;libopenblas&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.0&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x00002b098e0a1000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;libpython2&lt;/span&gt;&lt;span class="mf"&gt;.7&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.1.0&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;not&lt;/span&gt; &lt;span class="n"&gt;found&lt;/span&gt;
        &lt;span class="n"&gt;libgfortran&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.3&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;libgfortran&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.3&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x00002b098f00c000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;libm&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.6&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;libm&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.6&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x00002b098f331000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;libgcc_s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.1&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;libgcc_s&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.1&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x00002b098f5b4000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;libquadmath&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.0&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;libquadmath&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.0&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x00002b098f7cb000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;libc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.6&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;libc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.6&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x00002b098fa07000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;libpthread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.0&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;libpthread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.0&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x00002b098fd60000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ld&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x86&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;64.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;&lt;span class="mf"&gt;.2&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x0000003185e00000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Looks much healthier! (I've shortened some of the library paths)&lt;/p&gt;
&lt;h1&gt;Summary&lt;/h1&gt;
&lt;p&gt;I was able to install &lt;code&gt;numpy&lt;/code&gt; by first building and installing OpenBlas to a non-standard location, and then
manually building &lt;code&gt;numpy&lt;/code&gt; by creating the &lt;code&gt;site.cfg&lt;/code&gt; file to point to the OpenBlas libraries
and specifying which Fortan compiler to use.&lt;/p&gt;</summary><category term="python"></category><category term="numpy"></category></entry><entry><title>Ubuntu Server Virtual Machine with SSH using VirtualBox on Mac OS X</title><link href="https://leemendelowitz.github.io/blog/ubuntu-server-virtualbox.html" rel="alternate"></link><updated>2014-10-13T12:00:00+02:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2014-10-13:blog/ubuntu-server-virtualbox.html</id><summary type="html">&lt;p&gt;My laptop is a late 2011 MacBook Pro running OS X 10.9 Mavericks. It's my personal laptop, so I use it for everything - browsing, e-mail, and programming. While the OS X experience is wonderful, application development can be frustrating. For example, right now I'm trying to develop a Boost Python module, and I am having trouble compiling it on OS X.&lt;/p&gt;
&lt;p&gt;I intend to run my application in a Linux environment, so instead of learning the intricacies of porting my code and makefile to Mac OS X, I decided to install a local Ubuntu Server virtual machine (VM) on my MacBook. I installed Ubuntu Server instead of Ubuntu Desktop because I wanted to run a lightweight Linux environment, which should save laptop resources. I simply run the VM in the background, and ssh into it from the Mac terminal. Easy and awesome!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt; This entire tutorial should take approximately 20 minutes (not including download times). &lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;Install VirtualBox&lt;/h2&gt;
&lt;p&gt;Download and install VirtualBox &lt;a href="https://www.virtualbox.org/wiki/Downloads"&gt;here&lt;/a&gt;. The
instructions below were testing with VirtualBox 4.3.18 on OS X 10.9.5.&lt;/p&gt;
&lt;h2&gt;Download Ubuntu&lt;/h2&gt;
&lt;p&gt;Download the &lt;a href="http://www.ubuntu.com/download/server"&gt;Ubuntu Server 14.04.01 LTS&lt;/a&gt; iso image. &lt;/p&gt;
&lt;h2&gt;Setting up the Virtual Machine (VM)&lt;/h2&gt;
&lt;p&gt;You can configure your virtual machine (VM) using the VirtualBox graphical program, but it's quicker to set it up from the command line. I've adapted these commands in part from this &lt;a href="http://www.perkin.org.uk/posts/create-virtualbox-vm-from-the-command-line.html"&gt;blog post&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The commands below will create a virtual machine called "UbuntuServer",
attach a 32 GB virtual hard drive, attach a DVD
drive loaded with the Ubuntu Server disk image, and allocate 1 GB of RAM. We also 
attach a network card and set up port forwarding. &lt;/p&gt;
&lt;!-- All of these settings can be easily changed in the future (except expanding the virtual hard ddrive size is kind of tricky because you'll have to [resize the drive partition](http://www.howtogeek.com/124622/how-to-enlarge-a-virtual-machines-disk-in-virtualbox-or-vmware/)). If you are curious, you can read more about these vboxmanage commands by referring to the [VirtualBox documentation](https://www.virtualbox.org/manual/ch08.html). --&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; ~/VirtualBox&lt;span class="se"&gt;\ &lt;/span&gt;VMs/

&lt;span class="c"&gt;# Change these variables as needed&lt;/span&gt;
&lt;span class="nv"&gt;VM_NAME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;UbuntuServer&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;UBUNTU_ISO_PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;~/Downloads/ubuntu-14.04.1-server-amd64.iso
&lt;span class="nv"&gt;VM_HD_PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;UbuntuServer.vdi&amp;quot;&lt;/span&gt; &lt;span class="c"&gt;# The path to VM hard disk (to be created).&lt;/span&gt;
&lt;span class="nv"&gt;SHARED_PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;~ &lt;span class="c"&gt;# Share home directory with the VM&lt;/span&gt;


vboxmanage createvm --name &lt;span class="nv"&gt;$VM_NAME&lt;/span&gt; --ostype Ubuntu_64 --register
vboxmanage createhd --filename &lt;span class="nv"&gt;$VM_NAME&lt;/span&gt;.vdi --size 32768
vboxmanage storagectl &lt;span class="nv"&gt;$VM_NAME&lt;/span&gt; --name &lt;span class="s2"&gt;&amp;quot;SATA Controller&amp;quot;&lt;/span&gt; --add sata --controller IntelAHCI
vboxmanage storageattach &lt;span class="nv"&gt;$VM_NAME&lt;/span&gt; --storagectl &lt;span class="s2"&gt;&amp;quot;SATA Controller&amp;quot;&lt;/span&gt; --port 0 --device 0 --type hdd --medium &lt;span class="nv"&gt;$VM_HD_PATH&lt;/span&gt;
vboxmanage storagectl &lt;span class="nv"&gt;$VM_NAME&lt;/span&gt; --name &lt;span class="s2"&gt;&amp;quot;IDE Controller&amp;quot;&lt;/span&gt; --add ide
vboxmanage storageattach &lt;span class="nv"&gt;$VM_NAME&lt;/span&gt; --storagectl &lt;span class="s2"&gt;&amp;quot;IDE Controller&amp;quot;&lt;/span&gt; --port 0 --device 0 --type dvddrive --medium &lt;span class="nv"&gt;$UBUNTU_ISO_PATH&lt;/span&gt;
vboxmanage modifyvm &lt;span class="nv"&gt;$VM_NAME&lt;/span&gt; --ioapic on
vboxmanage modifyvm &lt;span class="nv"&gt;$VM_NAME&lt;/span&gt; --memory 1024 --vram 128
vboxmanage modifyvm &lt;span class="nv"&gt;$VM_NAME&lt;/span&gt; --nic1 nat
vboxmanage modifyvm &lt;span class="nv"&gt;$VM_NAME&lt;/span&gt; --natpf1 &lt;span class="s2"&gt;&amp;quot;guestssh,tcp,,2222,,22&amp;quot;&lt;/span&gt;
vboxmanage modifyvm &lt;span class="nv"&gt;$VM_NAME&lt;/span&gt; --natdnshostresolver1 on
vboxmanage sharedfolder add &lt;span class="nv"&gt;$VM_NAME&lt;/span&gt; --name shared --hostpath &lt;span class="nv"&gt;$SHARED_PATH&lt;/span&gt; --automount
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Start the VM for the first time&lt;/h3&gt;
&lt;p&gt;For the first boot, we will start the VM with a graphical display so we can install
the Ubuntu operating system. &lt;strong&gt;From your OS X terminal&lt;/strong&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;vboxmanage startvm UbuntuServer
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The VM will boot from the DVD Drive, which has the Ubuntu Server installation CD image loaded. &lt;/p&gt;
&lt;h3&gt;Install Ubuntu Server&lt;/h3&gt;
&lt;p&gt;Install Ubuntu Server using the installation wizard with the default settings. The installer is interactive - it should take about 10 minutes to complete the installation. As part of the installation you will be asked to select a username and a password. &lt;/p&gt;
&lt;p&gt;After installation is complete, the machine will reboot. Log in at the prompt.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Hint&lt;/strong&gt;: If you accidentally click on the VM GUI window, VirtualBox may "hijack" your mouse pointer to try passing it to the VM. If this happens and you lose your mouse pointer, press the left command key to get your mouse pointer back.&lt;/p&gt;
&lt;h3&gt;Install the OpenSSH Server&lt;/h3&gt;
&lt;p&gt;After installing the Ubuntu operating system and logging in to VM, to install the ssh server, issue the following command &lt;strong&gt;in the Ubuntu VM&lt;/strong&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;sudo apt-get update
sudo apt-get install -y openssh-server
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now you can try logging into your virtual machine over ssh through port 2222, which has been set up to forward to port 22 of your VM. &lt;strong&gt;From the OS X terminal&lt;/strong&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;ssh -p 2222 &amp;lt;username&amp;gt;@localhost
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Congrats! :-)&lt;/p&gt;
&lt;p&gt;For the rest of this installation guide, I recommend issuing all VM commands over ssh because the display is better than the VM GUI console, and you can easily paste commands into the Mac ssh terminal.&lt;/p&gt;
&lt;h3&gt;Install VirtualBox Guest Additions (for shared folders)&lt;/h3&gt;
&lt;p&gt;To share a folder from your host machine (i.e. Mac) with the VM, you need to install
the VirtualBox Guest Additions in the VM. &lt;/p&gt;
&lt;p&gt;Before you can install the Guest additions, you need to install &lt;code&gt;gcc&lt;/code&gt; and &lt;code&gt;make&lt;/code&gt; into the VM. Make sure your laptop is connected to the internet (&lt;strong&gt;in the VM&lt;/strong&gt;):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;sudo apt-get -y install gcc make linux-headers-&lt;span class="k"&gt;$(&lt;/span&gt;uname -r&lt;span class="k"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;From the VirtualBox VM GUI window menu, select "Devices -&amp;gt; Insert Guest Additions CD Image...". If prompted, choose "Force Unmount". &lt;/p&gt;
&lt;p&gt;This will insert the VirtualBox GuestAdditions installation CD into the VM's DVD drive. From the VM terminal (or, more comfortably, the ssh terminal), mount the CD drive and run the installation script. &lt;strong&gt;In the VM&lt;/strong&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;sudo mount /dev/sr0 /media/cdrom
sudo /media/cdrom/VBoxLinuxAdditions.run
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Finally, add your user to the &lt;code&gt;vboxsf&lt;/code&gt; group so you can access shared folders (&lt;strong&gt;in the VM&lt;/strong&gt;)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;sudo usermod -g vboxsf &amp;lt;username&amp;gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;For the GuestAdditions installation to take effect, you need to reboot the VM. We'll take care of that in the next section when we boot the VM without a GUI.&lt;/p&gt;
&lt;h3&gt;Starting the VM without GUI.&lt;/h3&gt;
&lt;p&gt;Now that ssh has been installed and configured, you can run the VM in the background without a GUI window.&lt;/p&gt;
&lt;p&gt;First, shutdown the VM using one of these methods:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;From the VM GUI, close the window and select "Send Shutdown Signal", OR&lt;/li&gt;
&lt;li&gt;From the VM GUI menu, select "Machine -&amp;gt; ACPI Shutdown" OR&lt;/li&gt;
&lt;li&gt;From the Mac terminal, issue &lt;code&gt;vboxmanage controlvm UbuntuServer poweroff&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Next, start the VM without a GUI from the OS X terminal:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;vboxmanage startvm UbuntuServer --type headless
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The VM will be running in the background. Give the VM a few moments to boot up, and then you can try to log in again over ssh as before from the OX X terminal: &lt;code&gt;ssh -p 2222 &amp;lt;username&amp;gt;@localhost&lt;/code&gt;.&lt;/p&gt;
&lt;h3&gt;Access shared folders&lt;/h3&gt;
&lt;p&gt;To access your Mac home directory from the VM:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;cd&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;media&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sf_shared&lt;/span&gt;
&lt;span class="n"&gt;ls&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Your files should be there. If you get a "permission denied", make sure you added your user to the &lt;code&gt;vboxsf&lt;/code&gt; group.&lt;/p&gt;
&lt;p&gt;Contratulations. Now you have a local lightweight Linux environment that you can access over ssh!&lt;/p&gt;
&lt;h2&gt;Quick Reference&lt;/h2&gt;
&lt;p&gt;To shutdown the VM:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;vboxmanage controlvm UbuntuServer poweroff
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can also pause the VM instead of shutting it down:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;vboxmanage controlvm UbuntuServer savestate
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To start the VM:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;vboxmanage startvm UbuntuServer --type headless
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To log into the VM over ssh:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;ssh -p 2222 &amp;lt;username&amp;gt;@localhost
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Additional Tweaks&lt;/h2&gt;
&lt;p&gt;Here are some solutions to other issues that may arise:&lt;/p&gt;
&lt;h3&gt;Configure the Grub Boot Loader&lt;/h3&gt;
&lt;p&gt;On one occasion I powered off the VM while it was booting. The next time time I tried to start the VM without the GUI, I could not log in over ssh because, unknown to me at the time, the VM was sitting in the GRUB bootloader menu waiting for my input. &lt;/p&gt;
&lt;p&gt;You can configure GRUB to timeout by editing the VM's GRUB configuration file at
&lt;code&gt;/etc/default/grub&lt;/code&gt; with the line:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;GRUB_RECORDFAIL_TIMEOUT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;which will
timeout the bootloader with the default selection after 2 seconds whenever the system
is started after the last boot failed. For more info, see the &lt;a href="https://help.ubuntu.com/community/Grub2"&gt;Ubuntu GRUB 2 page.&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;Keeping SSH Alive when laptop sleeps&lt;/h3&gt;
&lt;p&gt;Configure the VM ssh server to keep connections alive by editing the VM's config file
&lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt; and adding the following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;ClientAliveInterval 300
ClientAliveCountMax 2
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;When your laptop sleeps, you may find that your ssh connection to the VM is terimnated.
This is the result of some &lt;a href="https://www.virtualbox.org/ticket/12441"&gt;VirtualBox bug&lt;/a&gt; which has since been resolved provided that you change the VM's DNS resolution setting:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;VBoxManage modifyvm UbuntuServer --natdnshostresolver1 on
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;That did the trick for me.&lt;/p&gt;</summary><category term="Ubuntu"></category><category term="VirtualBox"></category></entry><entry><title>Decorating Python File Functions</title><link href="https://leemendelowitz.github.io/blog/decorating-python-file-functions.html" rel="alternate"></link><updated>2014-04-30T16:45:00+02:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2014-04-30:blog/decorating-python-file-functions.html</id><summary type="html">&lt;p&gt;Today I came up with a cool Python snippet that I'd like to share.
In my work I frequently write functions which write to or read from files, taking a &lt;code&gt;file&lt;/code&gt;-like
instance as the first argument &lt;code&gt;f&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;write_to_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;hi!&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To make things more flexible, we can modify the function to accept a &lt;code&gt;file&lt;/code&gt;-like instance or
a &lt;code&gt;str&lt;/code&gt; specifying the path to the file to open:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;write_to_file_ver2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;close&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; 
        &lt;span class="n"&gt;close&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;

    &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;hi!&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now we can pass this function a &lt;code&gt;file&lt;/code&gt; or a &lt;code&gt;str&lt;/code&gt; with a file path:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;hi.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;write_to_file_ver2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c"&gt;# Or&lt;/span&gt;

&lt;span class="n"&gt;write_to_file_ver2&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;hi.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This pattern is common enough that it's worth creating a decorator for it. We can wrap functions so they 
accept either a &lt;code&gt;file&lt;/code&gt;-like handle as the first argument, or a &lt;code&gt;str&lt;/code&gt; to a file.&lt;/p&gt;
&lt;p&gt;The decorated function &lt;code&gt;write_hi_ver3&lt;/code&gt; below is identical to &lt;code&gt;write_hi_ver2&lt;/code&gt; above, but with less code.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@wrap_file_function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;write_hi_ver_3&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;hi!&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The decorator can also wrap a function which takes multiple file handles by specifiying
multiple file access modes: &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nd"&gt;@wrap_file_function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;copy_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f2&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;f2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;copy_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;hi.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;hi.copy.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Here is the &lt;a href="https://gist.github.com/LeeMendelowitz/36941676def5c521a960"&gt;source&lt;/a&gt; for the decorator, which also takes care to close any files it opens
in the event that the wrapped function throws an exception:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;wrap_file_function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;  Wrap a function which takes a file or a str as it&amp;#39;s first argument.&lt;/span&gt;
&lt;span class="sd"&gt;  If a str is provided, replace the first argument of the wrapped function&lt;/span&gt;
&lt;span class="sd"&gt;  with a file handle, and close the file afterwards&lt;/span&gt;

&lt;span class="sd"&gt;  Example:&lt;/span&gt;

&lt;span class="sd"&gt;  @wrap_file_function(&amp;#39;w&amp;#39;)&lt;/span&gt;
&lt;span class="sd"&gt;  def write_hi(f):&lt;/span&gt;
&lt;span class="sd"&gt;    f.write(&amp;#39;hi!\n&amp;#39;)&lt;/span&gt;

&lt;span class="sd"&gt;  # This will write to already open file handle.&lt;/span&gt;
&lt;span class="sd"&gt;  f = open(&amp;#39;f1.txt&amp;#39;, &amp;#39;w&amp;#39;)&lt;/span&gt;
&lt;span class="sd"&gt;  write_hi(f)&lt;/span&gt;
&lt;span class="sd"&gt;  f.close()&lt;/span&gt;

&lt;span class="sd"&gt;  # This will open file f2.txt with mode &amp;#39;w&amp;#39;, write to it, and close the file.&lt;/span&gt;
&lt;span class="sd"&gt;  write_hi(&amp;#39;f2.txt&amp;#39;)&lt;/span&gt;
&lt;span class="sd"&gt;  &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;modes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,)&lt;/span&gt;

  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__call__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;wrapped&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

      &lt;span class="n"&gt;close&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="c"&gt;# Files that should be closed&lt;/span&gt;
      &lt;span class="n"&gt;files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="c"&gt;# File handles that should be passed to func&lt;/span&gt;
      &lt;span class="n"&gt;num_files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;modes&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

      &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;modes&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

          &lt;span class="n"&gt;fp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

          &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;fp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

          &lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="c"&gt;# Replace the files in args when calling func&lt;/span&gt;
        &lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;files&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;num_files&lt;/span&gt;&lt;span class="p"&gt;:])&lt;/span&gt;

        &lt;span class="c"&gt;# Make function call and return value&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

      &lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;fp&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;wrapped&lt;/span&gt;



&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

  &lt;span class="c"&gt;# Demonstration of wrapping a function which writes to a file.&lt;/span&gt;
  &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;
  &lt;span class="nd"&gt;@wrap_file_function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;write_hi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;hi!&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;temp.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;write_hi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;write_hi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;write_hi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

  &lt;span class="n"&gt;write_hi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;temp2.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


  &lt;span class="c"&gt;# Demonstration of wrapping a function which reads from a file.&lt;/span&gt;
  &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;
  &lt;span class="nd"&gt;@wrap_file_function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;read_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
      &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

  &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;temp.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Reading file temp.txt from handle f:&amp;#39;&lt;/span&gt;
  &lt;span class="n"&gt;read_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Reading file temp2.txt&amp;#39;&lt;/span&gt;
  &lt;span class="n"&gt;read_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;temp2.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="c"&gt;# Demonstration of wrapping a function takes multiple files&lt;/span&gt;
  &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;
  &lt;span class="nd"&gt;@wrap_file_function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;read_files&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f2&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
      &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;reading f1: &amp;#39;&lt;/span&gt;
      &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;f1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
      &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;reading f2: &amp;#39;&lt;/span&gt;
      &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;f2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

  &lt;span class="nd"&gt;@wrap_file_function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;read_write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f2&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;f2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

  &lt;span class="nd"&gt;@wrap_file_function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;write_to_from&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f1&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;f2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

  &lt;span class="n"&gt;read_files&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;temp.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;temp2.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="n"&gt;read_files&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;temp.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;temp2.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;read_write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;temp.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;temp.copy.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
  &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;writing temp.txt to stdout:&amp;#39;&lt;/span&gt;
  &lt;span class="n"&gt;read_write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;temp.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Contents of temp.copy.txt:&amp;#39;&lt;/span&gt;
  &lt;span class="n"&gt;read_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;temp.copy.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="nd"&gt;@wrap_file_function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;throw_exception&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;RuntimeError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;BLAH!&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;
  &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Reading a file that does not exist:&amp;#39;&lt;/span&gt;
  &lt;span class="n"&gt;write_to_from&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;dest.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;file_doesnt_exist.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="c"&gt;#print &amp;#39;-&amp;#39;*50&lt;/span&gt;
  &lt;span class="c"&gt;#throw_exception(&amp;#39;exception.txt&amp;#39;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;!-- the gist styles look bad! Instead, we'll just paste the source --!&gt;
&lt;!-- &lt;script src="https://gist.github.com/LeeMendelowitz/36941676def5c521a960.js"&gt;&lt;/script&gt; --&gt;

&lt;!-- [gist:id=36941676def5c521a960] --&gt;</summary><category term="python"></category></entry><entry><title>D3 Update Enter Exit Selections</title><link href="https://leemendelowitz.github.io/blog/d3-update-enter-exit-selections.html" rel="alternate"></link><updated>2014-04-28T12:00:00+02:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2014-04-28:blog/d3-update-enter-exit-selections.html</id><summary type="html">&lt;p&gt;Lately I've been playing around with the D3 javascript library for data visualizations in a browser. D3 stands for "Data Driven Documents" and provides utilities for manipulating elements on a webpage based on data. The D3 &lt;a href="https://github.com/mbostock/d3/wiki/Gallery"&gt;gallery&lt;/a&gt; is very impressive.&lt;/p&gt;
&lt;p&gt;I've had trouble wrapping my head around the update, enter, and exit selections, which provide a mechanism for updating, inserting, and removing elements from a page based on changes in data.&lt;/p&gt;
&lt;p&gt;There are already some great &lt;a href="https://github.com/mbostock/d3/wiki/Tutorials"&gt;tutorials&lt;/a&gt; by Mike Bostock and others on &lt;a href="http://bost.ocks.org/mike/join/"&gt;joins&lt;/a&gt;, &lt;a href="http://bl.ocks.org/mbostock/3808234"&gt;updates&lt;/a&gt; and &lt;a href="http://bost.ocks.org/mike/selection/"&gt;selections&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I challenged myself to create a demo which illustrates populating a table with changing data using the full update pattern. The table is a little more challenging because the data is nested; data is first bound to each row as an array of values, then data is bound to each cell of the row as a single value. We have to handle cases where cells are added to or deleted from existing rows, and where entire rows are added or deleted.&lt;/p&gt;
&lt;p&gt;You can see the demo below and check out the source &lt;a href="http://bl.ocks.org/LeeMendelowitz/11383724"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;iframe src="code/d3_updating_table.html" marginwidth="0" marginheight="0" width="600" height="1000"&gt;&lt;/iframe&gt;</summary><category term="d3"></category><category term="javascript"></category></entry><entry><title>Python OS X Mavericks Issues</title><link href="https://leemendelowitz.github.io/blog/python-mavericks-issues.html" rel="alternate"></link><updated>2014-03-29T02:00:00+01:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2014-03-29:blog/python-mavericks-issues.html</id><summary type="html">&lt;p&gt;Yesterday I decided to upgrade OS X on my Late-2011 Mac Book Pro from 10.7 Lion to 10.9 Mavericks. I felt no rush to upgrade - "If it ain't broke, don't fix it!" - but after reading about the new features, particularly the improved support for multiple displays - I decided to give it a shot.&lt;/p&gt;
&lt;p&gt;Everything went smoothly - except that my Python installation completely broke. This was a big break - I work in Python almost everyday. By broke, I mean that Apple wiped out all of the python libraries I've installed - pip, virtualenv, numpy, matplotlib, ipython, pandas, flask, greenlet - all gone.&lt;/p&gt;
&lt;p&gt;In retrospect, it was my mistake. I was installing packages in &lt;code&gt;/Library/Python/2.7/site-packages&lt;/code&gt;, which Apple wiped clean when I upgraded to Mavericks.&lt;/p&gt;
&lt;p&gt;I recovered by installing Python using Homebrew. It's a much better option because:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the installation will come with &lt;code&gt;pip&lt;/code&gt; installed&lt;/li&gt;
&lt;li&gt;the Python packages you install will be put in a safe place and you won't need to use &lt;code&gt;sudo&lt;/code&gt; to install them.&lt;/li&gt;
&lt;li&gt;You'll avoid some compilation errors when installing some packages.&lt;ul&gt;
&lt;li&gt;I encountered &lt;a href="http://stackoverflow.com/questions/22313407/clang-error-unknown-argument-mno-fused-madd-python-package-installation-fa"&gt;this&lt;/a&gt; issue when trying to install &lt;code&gt;greenlet&lt;/code&gt; package using an &lt;code&gt;easy_install&lt;/code&gt;'ed version of' &lt;code&gt;pip&lt;/code&gt;, but &lt;strong&gt;not&lt;/strong&gt; with the Homebrew installed &lt;code&gt;pip&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Here are the steps I followed to fix my Python installation:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;You need to reinstall XCode and the Command Line Tools to get a compiler. This can be done from the App Store. Lots of resources on how to do this - see &lt;a href="http://railsapps.github.io/xcode-command-line-tools.html"&gt;this&lt;/a&gt; or &lt;a href="http://railsapps.github.io/xcode-command-line-tools.html"&gt;this&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Install Python with &lt;a href="http://brew.sh"&gt;Homebrew&lt;/a&gt; instead of using the Python interpreter which ships with Mavericks. Homebrew will install the latest Python v2.7.6, while Mavericks ships with v2.7.5:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;brew update
brew install python
&lt;/pre&gt;&lt;/div&gt;


&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Upgrade setuptools and pip, as suggested:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;pip install --upgrade setuptools
pip install --upgrade pip
&lt;/pre&gt;&lt;/div&gt;


&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Install your favorite package&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;pip install numpy, ipython, matplotlib, pandas, flask, yolk
&lt;/pre&gt;&lt;/div&gt;


&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;These will be installed to &lt;code&gt;/usr/local/lib/python2.7/site-packages&lt;/code&gt;, which is a safe zone. Future OS X upgrades won't wipe out your installed packages.&lt;/p&gt;
&lt;p&gt;I'm still getting build errors on scipy that I have not yet resolved, but I'll save that for another rainy day.&lt;/p&gt;
&lt;p&gt;In conclusion, use Homebrew to stay &lt;em&gt;mostly&lt;/em&gt; sane.&lt;/p&gt;</summary><category term="python"></category></entry><entry><title>Any and All</title><link href="https://leemendelowitz.github.io/blog/any-all-in-python.html" rel="alternate"></link><updated>2014-01-31T12:42:00+01:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2014-01-31:blog/any-all-in-python.html</id><summary type="html">&lt;p&gt;Here's an &lt;a href="http://nbviewer.ipython.org/gist/LeeMendelowitz/8738004"&gt;ipython notebook&lt;/a&gt; with the code for this post, and the ipython notebook &lt;a href="https://gist.github.com/LeeMendelowitz/8738004"&gt;source&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;any&lt;/code&gt; and &lt;code&gt;all&lt;/code&gt; are useful Python functions. Given an iterable (like a list, a generator, an str, etc.), these functions check if any or all of the values are True (or "truthy"). Here is a simple example where we are checking the values of the letters in the word "python":&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;any&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;t&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;python&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;# Returns True. Same as: &amp;#39;t&amp;#39; in &amp;#39;python&amp;#39;&lt;/span&gt;
&lt;span class="nb"&gt;all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;t&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;python&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;# Returns False. Not all of the letters are &amp;#39;t&amp;#39;.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This seems like a simple function call, but things are slightly more complicated than they look.&lt;/p&gt;
&lt;p&gt;First, a generator is constructed from the expression &lt;code&gt;l == 't' for l in 'python'&lt;/code&gt;. What is a generator? A generator is an object which is both an iterator (has the &lt;code&gt;next&lt;/code&gt; method) and is also iterable (has the &lt;code&gt;__iter__&lt;/code&gt; method which returns an iterator). Strings themselves are iterable, which is how the &lt;code&gt;for l in 'python'&lt;/code&gt; part works.&lt;/p&gt;
&lt;p&gt;You can define a generator through a generator expression:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;g&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;t&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;python&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Note that a generator expression is similar to a list comprehension, except uses parentheses instead of brackets. A key difference is that while a list comprehension immediately computes all of the values and stores them in a list in memory, a generator expression generates its values lazily on demand.&lt;/p&gt;
&lt;p&gt;To show that &lt;code&gt;g&lt;/code&gt; is an iterator, we can get the first few values by hand:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="c"&gt;# False. &amp;#39;p&amp;#39; is not equal to &amp;#39;t&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="c"&gt;# False. &amp;#39;y&amp;#39; is not equal to &amp;#39;t&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="c"&gt;# True. &amp;#39;t&amp;#39; is equal to &amp;#39;t&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Again, these True/False responses are lazily computed by the generator only upon demand. You can also use &lt;code&gt;g&lt;/code&gt; in a loop, since it's iterable. Under the hood, the &lt;code&gt;for&lt;/code&gt; loop calls the &lt;code&gt;__iter__&lt;/code&gt; function of g:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;g&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;t&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;python&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Functions that accept iterable objects, like &lt;code&gt;any&lt;/code&gt; and &lt;code&gt;all&lt;/code&gt;, will accept a generator expression:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;g&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;t&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;python&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;any&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;any&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;t&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;python&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;# same thing&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Finally, python lets us avoid the "double parentheses" when we pass a generator expression to a function call:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;any&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;l&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;hello&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;# same thing as any((l == &amp;#39;t&amp;#39; for l in &amp;#39;python&amp;#39;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So that's how the function call itself works. How do &lt;code&gt;any&lt;/code&gt; and &lt;code&gt;all&lt;/code&gt; work with the iterable it is given? &lt;/p&gt;
&lt;p&gt;Let's demonstrate this with a simple example:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;t&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;In True!&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;f&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;In False!&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;

&lt;span class="c"&gt;# Store functions to be called in a list&lt;/span&gt;
&lt;span class="n"&gt;funcs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_any&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="c"&gt;# Pass a generator expression with function calls to any&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="nb"&gt;any&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;funcs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_all&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="c"&gt;# Pass a generator expression with function calls to all&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="nb"&gt;all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;funcs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;test_any&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="c"&gt;# Calls t() once and stops.&lt;/span&gt;
&lt;span class="n"&gt;test_all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="c"&gt;# Calls t(), then f(), then stops&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;In this example, &lt;code&gt;any&lt;/code&gt; stopped after the first True value it sees, and 
&lt;code&gt;all&lt;/code&gt; stopped after the first False value. This makes sense - both &lt;code&gt;any&lt;/code&gt; and &lt;code&gt;all&lt;/code&gt; can stop
iterating over their argument once they've figured out their return value. &lt;/p&gt;
&lt;p&gt;The more you know!&lt;/p&gt;</summary><category term="python"></category></entry><entry><title>Mathematical expressions in plots</title><link href="https://leemendelowitz.github.io/blog/mathematical-expressions-in-plots.html" rel="alternate"></link><updated>2013-10-15T00:00:00+02:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2013-10-15:blog/mathematical-expressions-in-plots.html</id><summary type="html">&lt;p&gt;&lt;a href="https://leemendelowitz.github.io/blog/computing_for_data_analysis/rmarkdown/plotmath.rmd"&gt;Download as R Markdown&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Mathematical expressions can be included in the plot title or axis labels. For more information, see &lt;code&gt;?plotmath&lt;/code&gt; or run the demo with &lt;code&gt;demo(plotmath)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Here are some quick examples.&lt;/p&gt;
&lt;h3&gt;Example 1&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;plot&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; main &lt;span class="o"&gt;=&lt;/span&gt; expression&lt;span class="p"&gt;(&lt;/span&gt;theta &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; ylab &lt;span class="o"&gt;=&lt;/span&gt; expression&lt;span class="p"&gt;(&lt;/span&gt;hat&lt;span class="p"&gt;(&lt;/span&gt;gamma&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; 
    xlab &lt;span class="o"&gt;=&lt;/span&gt; expression&lt;span class="p"&gt;(&lt;/span&gt;sum&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;[&lt;/span&gt;i&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; y&lt;span class="p"&gt;[&lt;/span&gt;i&lt;span class="p"&gt;],&lt;/span&gt; i &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; n&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk example1" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/plotmath_example1.png" /&gt; &lt;/p&gt;
&lt;h3&gt;Example 2&lt;/h3&gt;
&lt;p&gt;Strings can be pasted together with mathematic expressions:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;x &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
hist&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; xlab &lt;span class="o"&gt;=&lt;/span&gt; expression&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;The mean (&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; bar&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;) is &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; sum&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;[&lt;/span&gt;i&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;n&lt;span class="p"&gt;,&lt;/span&gt; i &lt;span class="o"&gt;==&lt;/span&gt; 
    &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; n&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk example2" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/plotmath_example2.png" /&gt; &lt;/p&gt;
&lt;h3&gt;Example 3&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;subsitute&lt;/code&gt; function can be used to substitute values into a
mathematical expression.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;x &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
y &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; x &lt;span class="o"&gt;+&lt;/span&gt; rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; sd &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
plot&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="p"&gt;,&lt;/span&gt; xlab &lt;span class="o"&gt;=&lt;/span&gt; substitute&lt;span class="p"&gt;(&lt;/span&gt;bar&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; k&lt;span class="p"&gt;,&lt;/span&gt; list&lt;span class="p"&gt;(&lt;/span&gt;k &lt;span class="o"&gt;=&lt;/span&gt; mean&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;))),&lt;/span&gt; ylab &lt;span class="o"&gt;=&lt;/span&gt; substitute&lt;span class="p"&gt;(&lt;/span&gt;bar&lt;span class="p"&gt;(&lt;/span&gt;y&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; 
    k&lt;span class="p"&gt;,&lt;/span&gt; list&lt;span class="p"&gt;(&lt;/span&gt;k &lt;span class="o"&gt;=&lt;/span&gt; mean&lt;span class="p"&gt;(&lt;/span&gt;y&lt;span class="p"&gt;))))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk example3" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/plotmath_example3.png" /&gt; &lt;/p&gt;</summary><category term="R"></category><category term="Computing For Data Analysis"></category></entry><entry><title>Plotting with Lattice</title><link href="https://leemendelowitz.github.io/blog/plotting-with-lattice.html" rel="alternate"></link><updated>2013-10-14T00:00:00+02:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2013-10-14:blog/plotting-with-lattice.html</id><summary type="html">&lt;p&gt;&lt;a href="https://leemendelowitz.github.io/blog/computing_for_data_analysis/rmarkdown/lattice_demo.rmd"&gt;Download as R Markdown&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The lattice library is useful for quickly making plots of multivariate data. It's easy to make plots which condition on one or more variables.&lt;/p&gt;
&lt;h3&gt;Load the lattice library&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;library&lt;span class="p"&gt;(&lt;/span&gt;lattice&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Ask for general information about the lattice package&lt;/span&gt;
&lt;span class="sb"&gt;`?`&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;package&lt;span class="p"&gt;,&lt;/span&gt; lattice&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# See what is inside of the lattice package. It includes some datasets.&lt;/span&gt;
library&lt;span class="p"&gt;(&lt;/span&gt;help &lt;span class="o"&gt;=&lt;/span&gt; lattice&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Load the New York City environmental dataset.&lt;/span&gt;
data&lt;span class="p"&gt;(&lt;/span&gt;environmental&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="sb"&gt;`?`&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;environmental&lt;span class="p"&gt;)&lt;/span&gt;
head&lt;span class="p"&gt;(&lt;/span&gt;environmental&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;##   ozone radiation temperature wind&lt;/span&gt;
&lt;span class="c"&gt;## 1    41       190          67  7.4&lt;/span&gt;
&lt;span class="c"&gt;## 2    36       118          72  8.0&lt;/span&gt;
&lt;span class="c"&gt;## 3    12       149          74 12.6&lt;/span&gt;
&lt;span class="c"&gt;## 4    18       313          62 11.5&lt;/span&gt;
&lt;span class="c"&gt;## 5    23       299          65  8.6&lt;/span&gt;
&lt;span class="c"&gt;## 6    19        99          59 13.8&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Plot ozone vs. radiation using xyplot&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;xyplot&lt;span class="p"&gt;(&lt;/span&gt;ozone &lt;span class="o"&gt;~&lt;/span&gt; radiation&lt;span class="p"&gt;,&lt;/span&gt; data &lt;span class="o"&gt;=&lt;/span&gt; environmental&lt;span class="p"&gt;,&lt;/span&gt; main &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Ozone vs. Radiation&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk section1" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section1.png" /&gt; &lt;/p&gt;
&lt;h3&gt;Investigate the relationship between ozone and radiation change as temperature changes&lt;/h3&gt;
&lt;p&gt;To address this, break temperature into 4 overlapping ranges using the &lt;code&gt;equal.count&lt;/code&gt; function.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;summary&lt;span class="p"&gt;(&lt;/span&gt;environmental&lt;span class="o"&gt;$&lt;/span&gt;temperature&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. &lt;/span&gt;
&lt;span class="c"&gt;##    57.0    71.0    79.0    77.8    84.5    97.0&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;# Cut the temperature variable into four different ranges.&lt;/span&gt;
temp.cut &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; equal.count&lt;span class="p"&gt;(&lt;/span&gt;environmental&lt;span class="o"&gt;$&lt;/span&gt;temperature&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
temp.cut
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## Data:&lt;/span&gt;
&lt;span class="c"&gt;##   [1] 67 72 74 62 65 59 61 69 66 68 58 64 66 57 68 62 59 73 61 61 67 81 79&lt;/span&gt;
&lt;span class="c"&gt;##  [24] 76 82 90 87 82 77 72 65 73 76 84 85 81 83 83 88 92 92 89 73 81 80 81&lt;/span&gt;
&lt;span class="c"&gt;##  [47] 82 84 87 85 74 86 85 82 86 88 86 83 81 81 81 82 89 90 90 86 82 80 77&lt;/span&gt;
&lt;span class="c"&gt;##  [70] 79 76 78 78 77 72 79 81 86 97 94 96 94 91 92 93 93 87 84 80 78 75 73&lt;/span&gt;
&lt;span class="c"&gt;##  [93] 81 76 77 71 71 78 67 76 68 82 64 71 81 69 63 70 75 76 68&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## Intervals:&lt;/span&gt;
&lt;span class="c"&gt;##    min  max count&lt;/span&gt;
&lt;span class="c"&gt;## 1 56.5 76.5    46&lt;/span&gt;
&lt;span class="c"&gt;## 2 67.5 81.5    51&lt;/span&gt;
&lt;span class="c"&gt;## 3 75.5 86.5    51&lt;/span&gt;
&lt;span class="c"&gt;## 4 80.5 97.5    51&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## Overlap between adjacent intervals:&lt;/span&gt;
&lt;span class="c"&gt;## [1] 27 30 31&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;# Default layout. This orders panel from left to right, bottom to top.&lt;/span&gt;
xyplot&lt;span class="p"&gt;(&lt;/span&gt;ozone &lt;span class="o"&gt;~&lt;/span&gt; radiation &lt;span class="o"&gt;|&lt;/span&gt; temp.cut&lt;span class="p"&gt;,&lt;/span&gt; data &lt;span class="o"&gt;=&lt;/span&gt; environmental&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk section2a" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section2a1.png" /&gt; &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;# One column layout.&lt;/span&gt;
xyplot&lt;span class="p"&gt;(&lt;/span&gt;ozone &lt;span class="o"&gt;~&lt;/span&gt; radiation &lt;span class="o"&gt;|&lt;/span&gt; temp.cut&lt;span class="p"&gt;,&lt;/span&gt; data &lt;span class="o"&gt;=&lt;/span&gt; environmental&lt;span class="p"&gt;,&lt;/span&gt; layout &lt;span class="o"&gt;=&lt;/span&gt; c&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk section2a" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section2a2.png" /&gt; &lt;/p&gt;
&lt;p&gt;Use the &lt;code&gt;as.table&lt;/code&gt; argument to draw panels in order from left to right, top to bottom.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c1"&gt;# One column, in ascending order of temperature range.&lt;/span&gt;
xyplot&lt;span class="p"&gt;(&lt;/span&gt;ozone &lt;span class="o"&gt;~&lt;/span&gt; radiation &lt;span class="o"&gt;|&lt;/span&gt; temp.cut&lt;span class="p"&gt;,&lt;/span&gt; data &lt;span class="o"&gt;=&lt;/span&gt; environmental&lt;span class="p"&gt;,&lt;/span&gt; as.table &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk section2b" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section2b.png" /&gt; &lt;/p&gt;
&lt;h3&gt;Add a fit to each panel.&lt;/h3&gt;
&lt;p&gt;Add a fit to each panel using a custom panel function. Note the use of &lt;code&gt;...&lt;/code&gt; which allows for the &lt;code&gt;xyplot&lt;/code&gt; parameters such as &lt;code&gt;pch&lt;/code&gt; to be passed through the custom panel function.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;xyplot&lt;span class="p"&gt;(&lt;/span&gt;ozone &lt;span class="o"&gt;~&lt;/span&gt; radiation &lt;span class="o"&gt;|&lt;/span&gt; temp.cut&lt;span class="p"&gt;,&lt;/span&gt; data &lt;span class="o"&gt;=&lt;/span&gt; environmental&lt;span class="p"&gt;,&lt;/span&gt; layout &lt;span class="o"&gt;=&lt;/span&gt; c&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; 
    as.table &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; pch &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; panel &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;...&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        panel.xyplot&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;...&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        fit &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class="p"&gt;(&lt;/span&gt;y &lt;span class="o"&gt;~&lt;/span&gt; x&lt;span class="p"&gt;)&lt;/span&gt;
        panel.abline&lt;span class="p"&gt;(&lt;/span&gt;fit&lt;span class="p"&gt;,&lt;/span&gt; lwd &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk section3" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section31.png" /&gt; &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;xyplot&lt;span class="p"&gt;(&lt;/span&gt;ozone &lt;span class="o"&gt;~&lt;/span&gt; radiation &lt;span class="o"&gt;|&lt;/span&gt; temp.cut&lt;span class="p"&gt;,&lt;/span&gt; data &lt;span class="o"&gt;=&lt;/span&gt; environmental&lt;span class="p"&gt;,&lt;/span&gt; as.table &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    pch &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; panel &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;...&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        panel.xyplot&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;...&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        panel.loess&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="p"&gt;,&lt;/span&gt; lwd &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt; xlab &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Solar Radiation&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; ylab &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Ozone (ppb)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; main &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Ozone vs. Solar Radiation&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk section3" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section32.png" /&gt; &lt;/p&gt;
&lt;h3&gt;Condition on both wind and temperature.&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;wind.cut &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; equal.count&lt;span class="p"&gt;(&lt;/span&gt;environmental&lt;span class="o"&gt;$&lt;/span&gt;wind&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
wind.cut
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## Data:&lt;/span&gt;
&lt;span class="c"&gt;##   [1]  7.4  8.0 12.6 11.5  8.6 13.8 20.1  9.7  9.2 10.9 13.2 11.5 12.0 18.4&lt;/span&gt;
&lt;span class="c"&gt;##  [15] 11.5  9.7  9.7 16.6  9.7 12.0 12.0 14.9  5.7  7.4  9.7 13.8 11.5  8.0&lt;/span&gt;
&lt;span class="c"&gt;##  [29] 14.9 20.7  9.2 11.5 10.3  4.0  9.2  9.2  4.6 10.9  5.1  6.3  5.7  7.4&lt;/span&gt;
&lt;span class="c"&gt;##  [43] 14.3 14.9 14.3  6.9 10.3  6.3  5.1 11.5  6.9  8.6  8.0  8.6 12.0  7.4&lt;/span&gt;
&lt;span class="c"&gt;##  [57]  7.4  7.4  9.2  6.9 13.8  7.4  4.0 10.3  8.0 11.5 11.5  9.7 10.3  6.3&lt;/span&gt;
&lt;span class="c"&gt;##  [71]  7.4 10.9 10.3 15.5 14.3  9.7  3.4  8.0  9.7  2.3  6.3  6.3  6.9  5.1&lt;/span&gt;
&lt;span class="c"&gt;##  [85]  2.8  4.6  7.4 15.5 10.9 10.3 10.9  9.7 14.9 15.5  6.3 10.9 11.5  6.9&lt;/span&gt;
&lt;span class="c"&gt;##  [99] 13.8 10.3 10.3  8.0 12.6  9.2 10.3 10.3 16.6  6.9 14.3  8.0 11.5&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## Intervals:&lt;/span&gt;
&lt;span class="c"&gt;##     min   max count&lt;/span&gt;
&lt;span class="c"&gt;## 1  2.05  9.45    49&lt;/span&gt;
&lt;span class="c"&gt;## 2  6.65 10.55    50&lt;/span&gt;
&lt;span class="c"&gt;## 3  8.95 12.85    47&lt;/span&gt;
&lt;span class="c"&gt;## 4 10.05 20.95    53&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## Overlap between adjacent intervals:&lt;/span&gt;
&lt;span class="c"&gt;## [1] 31 25 32&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;xyplot&lt;span class="p"&gt;(&lt;/span&gt;ozone &lt;span class="o"&gt;~&lt;/span&gt; radiation &lt;span class="o"&gt;|&lt;/span&gt; temp.cut &lt;span class="o"&gt;*&lt;/span&gt; wind.cut&lt;span class="p"&gt;,&lt;/span&gt; data &lt;span class="o"&gt;=&lt;/span&gt; environmental&lt;span class="p"&gt;,&lt;/span&gt; as.table &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    pch &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; panel &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;...&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        panel.xyplot&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;...&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        panel.loess&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt; xlab &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Solar Radiation&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; ylab &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Ozone (ppb)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; main &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Ozone vs. Solar Radiation&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk section4" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section4.png" /&gt; &lt;/p&gt;
&lt;h3&gt;splom&lt;/h3&gt;
&lt;p&gt;Use splom to draw conditional scatter plot matrices.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;splom&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;environmental&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk section5" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section5.png" /&gt; &lt;/p&gt;
&lt;h3&gt;histogram&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;histogram&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;temperature &lt;span class="o"&gt;|&lt;/span&gt; wind.cut&lt;span class="p"&gt;,&lt;/span&gt; data &lt;span class="o"&gt;=&lt;/span&gt; environmental&lt;span class="p"&gt;,&lt;/span&gt; as.table &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk section 6" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section_61.png" /&gt; &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;histogram&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;ozone &lt;span class="o"&gt;|&lt;/span&gt; wind.cut&lt;span class="p"&gt;,&lt;/span&gt; data &lt;span class="o"&gt;=&lt;/span&gt; environmental&lt;span class="p"&gt;,&lt;/span&gt; as.table &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk section 6" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section_62.png" /&gt; &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;histogram&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;ozone &lt;span class="o"&gt;|&lt;/span&gt; wind.cut &lt;span class="o"&gt;*&lt;/span&gt; temp.cut&lt;span class="p"&gt;,&lt;/span&gt; data &lt;span class="o"&gt;=&lt;/span&gt; environmental&lt;span class="p"&gt;,&lt;/span&gt; as.table &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk section 6" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/latticeplotting_section_63.png" /&gt; &lt;/p&gt;</summary><category term="R"></category><category term="Computing For Data Analysis"></category></entry><entry><title>mapply</title><link href="https://leemendelowitz.github.io/blog/mapply.html" rel="alternate"></link><updated>2013-10-13T00:00:00+02:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2013-10-13:blog/mapply.html</id><summary type="html">&lt;!--- mapply --&gt;

&lt;p&gt;&lt;a href="https://leemendelowitz.github.io/blog/computing_for_data_analysis/rmarkdown/mapply.rmd"&gt;Download as R Markdown&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;mapply&lt;/code&gt; gives us a way to call a non-vectorized function in a vectorized way.&lt;/p&gt;
&lt;p&gt;From the R Documentation:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;mapply&lt;/span&gt; &lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;multivariate&lt;/span&gt; &lt;span class="n"&gt;version&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;sapply&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;mapply&lt;/span&gt; &lt;span class="n"&gt;applies&lt;/span&gt; &lt;span class="n"&gt;FUN&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt;
&lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt; &lt;span class="n"&gt;elements&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;each&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt; &lt;span class="n"&gt;argument&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;second&lt;/span&gt; &lt;span class="n"&gt;elements&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="n"&gt;third&lt;/span&gt; &lt;span class="n"&gt;elements&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;and&lt;/span&gt; &lt;span class="n"&gt;so&lt;/span&gt; &lt;span class="n"&gt;on&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Arguments&lt;/span&gt; &lt;span class="n"&gt;are&lt;/span&gt; &lt;span class="n"&gt;recycled&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;necessary&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;mapply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;FUN&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...,&lt;/span&gt; &lt;span class="n"&gt;MoreArgs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;SIMPLIFY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
       &lt;span class="n"&gt;USE&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;NAMES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Example&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;list&lt;span class="p"&gt;(&lt;/span&gt;rep&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; rep&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; rep&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; rep&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;## [[1]]&lt;/span&gt;
&lt;span class="c"&gt;## [1] 1 1 1 1&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## [[2]]&lt;/span&gt;
&lt;span class="c"&gt;## [1] 2 2 2&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## [[3]]&lt;/span&gt;
&lt;span class="c"&gt;## [1] 3 3&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## [[4]]&lt;/span&gt;
&lt;span class="c"&gt;## [1] 4&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;We see that we are repeatedly calling the same function (&lt;code&gt;rep&lt;/code&gt;) where the first argument varies from 1 to 4, and the second argument varies from 4 to 1.
Instead, we can use &lt;code&gt;mapply&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;mapply&lt;span class="p"&gt;(&lt;/span&gt;rep&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;## [[1]]&lt;/span&gt;
&lt;span class="c"&gt;## [1] 1 1 1 1&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## [[2]]&lt;/span&gt;
&lt;span class="c"&gt;## [1] 2 2 2&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## [[3]]&lt;/span&gt;
&lt;span class="c"&gt;## [1] 3 3&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## [[4]]&lt;/span&gt;
&lt;span class="c"&gt;## [1] 4&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Example&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;noise &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;n&lt;span class="p"&gt;,&lt;/span&gt; mean&lt;span class="p"&gt;,&lt;/span&gt; std&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    rnorm&lt;span class="p"&gt;(&lt;/span&gt;n&lt;span class="p"&gt;,&lt;/span&gt; mean&lt;span class="p"&gt;,&lt;/span&gt; std&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
noise&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;## [1] 0.84136 0.04806 1.89196 2.76464 4.95360&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The noise function is not vectorized. &lt;code&gt;mapply&lt;/code&gt; gives us a way to make a vectorized call to  &lt;code&gt;noise&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;mapply&lt;span class="p"&gt;(&lt;/span&gt;noise&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;## [[1]]&lt;/span&gt;
&lt;span class="c"&gt;## [1] 1.625&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## [[2]]&lt;/span&gt;
&lt;span class="c"&gt;## [1]  2.928 -1.840&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## [[3]]&lt;/span&gt;
&lt;span class="c"&gt;## [1] 2.459 4.195 1.939&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## [[4]]&lt;/span&gt;
&lt;span class="c"&gt;## [1] 5.195 3.731 5.249 2.959&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## [[5]]&lt;/span&gt;
&lt;span class="c"&gt;## [1] 8.291 1.949 5.751 4.250 4.868&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="R"></category><category term="Computing For Data Analysis"></category></entry><entry><title>R Base Graphics Plotting</title><link href="https://leemendelowitz.github.io/blog/r-base-graphics-plotting.html" rel="alternate"></link><updated>2013-10-13T00:00:00+02:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2013-10-13:blog/r-base-graphics-plotting.html</id><summary type="html">&lt;!--- R Base Graphics Plotting --&gt;

&lt;p&gt;&lt;a href="https://leemendelowitz.github.io/blog/computing_for_data_analysis/rmarkdown/basePlotting.rmd"&gt;Download as R Markdown&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;Important parameters&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;pch&lt;/strong&gt;: plotting symbol&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;lty&lt;/strong&gt;: line type&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;lwd&lt;/strong&gt;: line width&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;col&lt;/strong&gt;: plotting color&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;las&lt;/strong&gt;: orientation of axis labels &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;bg&lt;/strong&gt;: background color&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;mar&lt;/strong&gt;: margin size&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;oma&lt;/strong&gt;: outer margin size&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;mfrow&lt;/strong&gt;: number of plots per row, column. Plots filled in row-wise.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;mfcol&lt;/strong&gt;: number of plots per row, column. Plots filled in column-wise.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Import functions&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;plot&lt;/strong&gt;: make scatterplot&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;lines&lt;/strong&gt;: add lines to plot&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;points&lt;/strong&gt;: add points to plot&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;text&lt;/strong&gt;: add text&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;title&lt;/strong&gt;: add title to axes or plot&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;mtext&lt;/strong&gt;: add margin text&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;axis&lt;/strong&gt;: add axis tick/labels&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Example 1&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;x &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
y &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
plot&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="p"&gt;,&lt;/span&gt; pch &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;21&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; mar &lt;span class="o"&gt;=&lt;/span&gt; c&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; col &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; bg &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;black&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; xlim &lt;span class="o"&gt;=&lt;/span&gt; c&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;-3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; ylim &lt;span class="o"&gt;=&lt;/span&gt; c&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;-3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
fit &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class="p"&gt;(&lt;/span&gt;y &lt;span class="o"&gt;~&lt;/span&gt; x&lt;span class="p"&gt;)&lt;/span&gt;
abline&lt;span class="p"&gt;(&lt;/span&gt;fit&lt;span class="p"&gt;,&lt;/span&gt; lwd &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; col &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
title&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;My plot&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
text&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;-2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;-2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;My Label&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
legend&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;topleft&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; legend &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Data&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; pch &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;21&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; pt.bg &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;black&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; col &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk example1" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/baseplotting_example1.png" /&gt; &lt;/p&gt;
&lt;h3&gt;Example 2&lt;/h3&gt;
&lt;p&gt;To use multiple plots per page, give a &lt;code&gt;mfrow&lt;/code&gt; argument to plot. Then the plots will be filled from left to right across the rows. (Specifying &lt;code&gt;mfcol&lt;/code&gt; will fill in plots from top to bottom down the 
columns. )&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;z &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; rpois&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
plot.new&lt;span class="p"&gt;()&lt;/span&gt;
par&lt;span class="p"&gt;(&lt;/span&gt;mfrow &lt;span class="o"&gt;=&lt;/span&gt; c&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
par&lt;span class="p"&gt;(&lt;/span&gt;mar &lt;span class="o"&gt;=&lt;/span&gt; c&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
plot&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="p"&gt;,&lt;/span&gt; pch &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; main &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;plot 1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
plot&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; z&lt;span class="p"&gt;,&lt;/span&gt; pch &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; main &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;plot 2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
plot&lt;span class="p"&gt;(&lt;/span&gt;y&lt;span class="p"&gt;,&lt;/span&gt; z&lt;span class="p"&gt;,&lt;/span&gt; pch &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; main &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;plot 3&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk example2" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/baseplotting_example2.png" /&gt; &lt;/p&gt;
&lt;h3&gt;Example 3&lt;/h3&gt;
&lt;p&gt;The &lt;code&gt;points&lt;/code&gt; function is useful for adding points to a plot for different groups.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;plot.new&lt;span class="p"&gt;()&lt;/span&gt;
x &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
y &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; x &lt;span class="o"&gt;+&lt;/span&gt; rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
g &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; gl&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; labels &lt;span class="o"&gt;=&lt;/span&gt; c&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Male&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Female&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
str&lt;span class="p"&gt;(&lt;/span&gt;g&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;##  Factor w/ 2 levels &amp;quot;Male&amp;quot;,&amp;quot;Female&amp;quot;: 1 1 1 1 1 1 1 1 1 1 ...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;plot&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; y&lt;span class="p"&gt;,&lt;/span&gt; type &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# Draws no points&lt;/span&gt;
points&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;[&lt;/span&gt;g &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Male&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; y&lt;span class="p"&gt;[&lt;/span&gt;g &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Male&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; col &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; pch &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
points&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;[&lt;/span&gt;g &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Female&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; y&lt;span class="p"&gt;[&lt;/span&gt;g &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Female&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; col &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; pch &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
legend&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;topleft&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; c&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Male&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Female&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; col &lt;span class="o"&gt;=&lt;/span&gt; c&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; pch &lt;span class="o"&gt;=&lt;/span&gt; c&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="plot of chunk example3" src="https://leemendelowitz.github.io/blog/computing_for_data_analysis/figure/baseplotting_example3.png" /&gt; &lt;/p&gt;</summary><category term="R"></category><category term="Computing For Data Analysis"></category></entry><entry><title>tapply and split</title><link href="https://leemendelowitz.github.io/blog/tapply-and-split.html" rel="alternate"></link><updated>2013-10-13T00:00:00+02:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2013-10-13:blog/tapply-and-split.html</id><summary type="html">&lt;!--- tapply and split --&gt;

&lt;p&gt;&lt;a href="https://leemendelowitz.github.io/blog/computing_for_data_analysis/rmarkdown/tapply_and_split.rmd"&gt;Download as R Markdown&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;tapply&lt;/h2&gt;
&lt;p&gt;Apply a function over subsets of a vector.&lt;/p&gt;
&lt;h3&gt;Example: Take group means with tapply.&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;x &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; c&lt;span class="p"&gt;(&lt;/span&gt;rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; runif&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
x
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;##  [1] -2.04333  0.72651  1.55476 -0.12411  1.08133 -0.30514  1.38638&lt;/span&gt;
&lt;span class="c"&gt;##  [8]  0.35047  0.88147  1.80250  0.56072  0.54421  0.19270  0.67049&lt;/span&gt;
&lt;span class="c"&gt;## [15]  0.83034  0.02640  0.98629  0.11223  0.10747  0.85049  1.37510&lt;/span&gt;
&lt;span class="c"&gt;## [22]  0.56575  0.34138  1.01877  1.33956 -0.07667  2.12114  0.70827&lt;/span&gt;
&lt;span class="c"&gt;## [29]  0.53336  2.15315&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;f &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; gl&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# Generator factors&lt;/span&gt;
f
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;##  [1] 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3&lt;/span&gt;
&lt;span class="c"&gt;## Levels: 1 2 3&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;By default, if the applied function returns a scalar, then tapply
returns a vector. In this case we are applying the mean function,
so the output of tapply is a numeric vector.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;tapply&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; f&lt;span class="p"&gt;,&lt;/span&gt; mean&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# Take the mean of each group. Returns a vector.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;##      1      2      3 &lt;/span&gt;
&lt;span class="c"&gt;## 0.5311 0.4881 1.0080&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Without simplification, tapply always returns a list.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;tapply&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; f&lt;span class="p"&gt;,&lt;/span&gt; mean&lt;span class="p"&gt;,&lt;/span&gt; simplify &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;FALSE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;## $`1`&lt;/span&gt;
&lt;span class="c"&gt;## [1] 0.5311&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## $`2`&lt;/span&gt;
&lt;span class="c"&gt;## [1] 0.4881&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## $`3`&lt;/span&gt;
&lt;span class="c"&gt;## [1] 1.008&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Example: Find the group range&lt;/h3&gt;
&lt;p&gt;Range returns the minimum and maximum value for each group.
Note that since the range function returns a vector, tapply returns
a list.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;tapply&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; f&lt;span class="p"&gt;,&lt;/span&gt; range&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;## $`1`&lt;/span&gt;
&lt;span class="c"&gt;## [1] -2.043  1.803&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## $`2`&lt;/span&gt;
&lt;span class="c"&gt;## [1] 0.0264 0.9863&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## $`3`&lt;/span&gt;
&lt;span class="c"&gt;## [1] -0.07667  2.15315&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;split&lt;/h2&gt;
&lt;p&gt;The split function splits a vector int groups using a factor.
Using split and then applying a function with lapply produces the same 
resule as tapply:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;split&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; f&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;## $`1`&lt;/span&gt;
&lt;span class="c"&gt;##  [1] -2.0433  0.7265  1.5548 -0.1241  1.0813 -0.3051  1.3864  0.3505&lt;/span&gt;
&lt;span class="c"&gt;##  [9]  0.8815  1.8025&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## $`2`&lt;/span&gt;
&lt;span class="c"&gt;##  [1] 0.5607 0.5442 0.1927 0.6705 0.8303 0.0264 0.9863 0.1122 0.1075 0.8505&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## $`3`&lt;/span&gt;
&lt;span class="c"&gt;##  [1]  1.37510  0.56575  0.34138  1.01877  1.33956 -0.07667  2.12114&lt;/span&gt;
&lt;span class="c"&gt;##  [8]  0.70827  0.53336  2.15315&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;lapply&lt;span class="p"&gt;(&lt;/span&gt;split&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; f&lt;span class="p"&gt;),&lt;/span&gt; mean&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# Instead of tapply&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;## $`1`&lt;/span&gt;
&lt;span class="c"&gt;## [1] 0.5311&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## $`2`&lt;/span&gt;
&lt;span class="c"&gt;## [1] 0.4881&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## $`3`&lt;/span&gt;
&lt;span class="c"&gt;## [1] 1.008&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Example: Air Quality by month&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;library&lt;span class="p"&gt;(&lt;/span&gt;datasets&lt;span class="p"&gt;)&lt;/span&gt;
head&lt;span class="p"&gt;(&lt;/span&gt;airquality&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;##   Ozone Solar.R Wind Temp Month Day&lt;/span&gt;
&lt;span class="c"&gt;## 1    41     190  7.4   67     5   1&lt;/span&gt;
&lt;span class="c"&gt;## 2    36     118  8.0   72     5   2&lt;/span&gt;
&lt;span class="c"&gt;## 3    12     149 12.6   74     5   3&lt;/span&gt;
&lt;span class="c"&gt;## 4    18     313 11.5   62     5   4&lt;/span&gt;
&lt;span class="c"&gt;## 5    NA      NA 14.3   56     5   5&lt;/span&gt;
&lt;span class="c"&gt;## 6    28      NA 14.9   66     5   6&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;s &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; split&lt;span class="p"&gt;(&lt;/span&gt;airquality&lt;span class="p"&gt;,&lt;/span&gt; airquality&lt;span class="o"&gt;$&lt;/span&gt;Month&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;code&gt;s&lt;/code&gt; is a list of dataframes split by month:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;class&lt;span class="p"&gt;(&lt;/span&gt;s&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;## [1] &amp;quot;list&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;class&lt;span class="p"&gt;(&lt;/span&gt;s&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;## [1] &amp;quot;data.frame&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;lapply&lt;span class="p"&gt;(&lt;/span&gt;s&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;)&lt;/span&gt; head&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; n &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;## $`5`&lt;/span&gt;
&lt;span class="c"&gt;##   Ozone Solar.R Wind Temp Month Day&lt;/span&gt;
&lt;span class="c"&gt;## 1    41     190  7.4   67     5   1&lt;/span&gt;
&lt;span class="c"&gt;## 2    36     118  8.0   72     5   2&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## $`6`&lt;/span&gt;
&lt;span class="c"&gt;##    Ozone Solar.R Wind Temp Month Day&lt;/span&gt;
&lt;span class="c"&gt;## 32    NA     286  8.6   78     6   1&lt;/span&gt;
&lt;span class="c"&gt;## 33    NA     287  9.7   74     6   2&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## $`7`&lt;/span&gt;
&lt;span class="c"&gt;##    Ozone Solar.R Wind Temp Month Day&lt;/span&gt;
&lt;span class="c"&gt;## 62   135     269  4.1   84     7   1&lt;/span&gt;
&lt;span class="c"&gt;## 63    49     248  9.2   85     7   2&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## $`8`&lt;/span&gt;
&lt;span class="c"&gt;##    Ozone Solar.R Wind Temp Month Day&lt;/span&gt;
&lt;span class="c"&gt;## 93    39      83  6.9   81     8   1&lt;/span&gt;
&lt;span class="c"&gt;## 94     9      24 13.8   81     8   2&lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## $`9`&lt;/span&gt;
&lt;span class="c"&gt;##     Ozone Solar.R Wind Temp Month Day&lt;/span&gt;
&lt;span class="c"&gt;## 124    96     167  6.9   91     9   1&lt;/span&gt;
&lt;span class="c"&gt;## 125    78     197  5.1   92     9   2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;After splitting by month, we can use &lt;code&gt;lapply&lt;/code&gt; to take the column means:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;takeMeans &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="kr"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;)&lt;/span&gt; colMeans&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;[,&lt;/span&gt; c&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Ozone&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Solar.R&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Wind&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)],&lt;/span&gt; na.rm &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
lapply&lt;span class="p"&gt;(&lt;/span&gt;s&lt;span class="p"&gt;,&lt;/span&gt; takeMeans&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;## $`5`&lt;/span&gt;
&lt;span class="c"&gt;##   Ozone Solar.R    Wind &lt;/span&gt;
&lt;span class="c"&gt;##   23.62  181.30   11.62 &lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## $`6`&lt;/span&gt;
&lt;span class="c"&gt;##   Ozone Solar.R    Wind &lt;/span&gt;
&lt;span class="c"&gt;##   29.44  190.17   10.27 &lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## $`7`&lt;/span&gt;
&lt;span class="c"&gt;##   Ozone Solar.R    Wind &lt;/span&gt;
&lt;span class="c"&gt;##  59.115 216.484   8.942 &lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## $`8`&lt;/span&gt;
&lt;span class="c"&gt;##   Ozone Solar.R    Wind &lt;/span&gt;
&lt;span class="c"&gt;##  59.962 171.857   8.794 &lt;/span&gt;
&lt;span class="c"&gt;## &lt;/span&gt;
&lt;span class="c"&gt;## $`9`&lt;/span&gt;
&lt;span class="c"&gt;##   Ozone Solar.R    Wind &lt;/span&gt;
&lt;span class="c"&gt;##   31.45  167.43   10.18&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Using &lt;code&gt;sapply&lt;/code&gt; instead of &lt;code&gt;lapply&lt;/code&gt; simplifies the output into a matrix,
so we can easily see the mean values by month.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;sapply&lt;span class="p"&gt;(&lt;/span&gt;s&lt;span class="p"&gt;,&lt;/span&gt; takeMeans&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;##              5      6       7       8      9&lt;/span&gt;
&lt;span class="c"&gt;## Ozone    23.62  29.44  59.115  59.962  31.45&lt;/span&gt;
&lt;span class="c"&gt;## Solar.R 181.30 190.17 216.484 171.857 167.43&lt;/span&gt;
&lt;span class="c"&gt;## Wind     11.62  10.27   8.942   8.794  10.18&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;Splitting on more than one level&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;x &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; rnorm&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
f1 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; gl&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# Create a factor with two levels&lt;/span&gt;
f2 &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; gl&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# Create a factor with five levels&lt;/span&gt;
str&lt;span class="p"&gt;(&lt;/span&gt;f1&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;##  Factor w/ 2 levels &amp;quot;1&amp;quot;,&amp;quot;2&amp;quot;: 1 1 1 1 1 2 2 2 2 2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;str&lt;span class="p"&gt;(&lt;/span&gt;f2&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;##  Factor w/ 5 levels &amp;quot;1&amp;quot;,&amp;quot;2&amp;quot;,&amp;quot;3&amp;quot;,&amp;quot;4&amp;quot;,..: 1 1 2 2 3 3 4 4 5 5&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;interaction&lt;span class="p"&gt;(&lt;/span&gt;f1&lt;span class="p"&gt;,&lt;/span&gt; f2&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# Compute a factor with 10 levels, which is the interaction of the two factors&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;##  [1] 1.1 1.1 1.2 1.2 1.3 2.3 2.4 2.4 2.5 2.5&lt;/span&gt;
&lt;span class="c"&gt;## Levels: 1.1 2.1 1.2 2.2 1.3 2.3 1.4 2.4 1.5 2.5&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Note that some levels of the interaction are empty for our data vector &lt;code&gt;x&lt;/code&gt;. For example, none of the samples in &lt;code&gt;x&lt;/code&gt; have level 2.1.&lt;/p&gt;
&lt;p&gt;We can use multiple factor levels with &lt;code&gt;split&lt;/code&gt; by passing the interaction
factor. Instead of calling &lt;code&gt;interaction&lt;/code&gt; explicitly, if we pass the factors in a list, the &lt;code&gt;interaction&lt;/code&gt; function is automatically called:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;str&lt;span class="p"&gt;(&lt;/span&gt;split&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; list&lt;span class="p"&gt;(&lt;/span&gt;f1&lt;span class="p"&gt;,&lt;/span&gt; f2&lt;span class="p"&gt;)))&lt;/span&gt;  &lt;span class="c1"&gt;# Automatically calls interaction(f1,f2)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;## List of 10&lt;/span&gt;
&lt;span class="c"&gt;##  $ 1.1: num [1:2] 0.993 0.939&lt;/span&gt;
&lt;span class="c"&gt;##  $ 2.1: num(0) &lt;/span&gt;
&lt;span class="c"&gt;##  $ 1.2: num [1:2] 1.092 -0.382&lt;/span&gt;
&lt;span class="c"&gt;##  $ 2.2: num(0) &lt;/span&gt;
&lt;span class="c"&gt;##  $ 1.3: num -0.985&lt;/span&gt;
&lt;span class="c"&gt;##  $ 2.3: num 1.53&lt;/span&gt;
&lt;span class="c"&gt;##  $ 1.4: num(0) &lt;/span&gt;
&lt;span class="c"&gt;##  $ 2.4: num [1:2] -0.066 -1.64&lt;/span&gt;
&lt;span class="c"&gt;##  $ 1.5: num(0) &lt;/span&gt;
&lt;span class="c"&gt;##  $ 2.5: num [1:2] 0.452 -1.324&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Note that some levels are empty, but they still appear in list output by
&lt;code&gt;split&lt;/code&gt;.  Empty levels can be dropped by passing  &lt;code&gt;drop = TRUE&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;str&lt;span class="p"&gt;(&lt;/span&gt;split&lt;span class="p"&gt;(&lt;/span&gt;x&lt;span class="p"&gt;,&lt;/span&gt; list&lt;span class="p"&gt;(&lt;/span&gt;f1&lt;span class="p"&gt;,&lt;/span&gt; f2&lt;span class="p"&gt;),&lt;/span&gt; drop &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;## List of 6&lt;/span&gt;
&lt;span class="c"&gt;##  $ 1.1: num [1:2] 0.993 0.939&lt;/span&gt;
&lt;span class="c"&gt;##  $ 1.2: num [1:2] 1.092 -0.382&lt;/span&gt;
&lt;span class="c"&gt;##  $ 1.3: num -0.985&lt;/span&gt;
&lt;span class="c"&gt;##  $ 2.3: num 1.53&lt;/span&gt;
&lt;span class="c"&gt;##  $ 2.4: num [1:2] -0.066 -1.64&lt;/span&gt;
&lt;span class="c"&gt;##  $ 2.5: num [1:2] 0.452 -1.324&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="R"></category><category term="Computing For Data Analysis"></category></entry><entry><title>Parsing in Python</title><link href="https://leemendelowitz.github.io/blog/parsing-in-python.html" rel="alternate"></link><updated>2013-10-03T22:07:00+02:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2013-10-03:blog/parsing-in-python.html</id><summary type="html">&lt;p&gt;In Python, everything is an object. Even the built-in types themselves
(i.e. int, str, dict, list, etc.) are object's of type type. 
You can use the built-in type function to get an object's type.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;# Returns type. So int is an object of type type.&lt;/span&gt;
&lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;# Returns True&lt;/span&gt;
&lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;# Returns True&lt;/span&gt;
&lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;# Returns type. So type is an object of type type. Truth.&lt;/span&gt;
&lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;# Returns type. So object is an object of type type. Mind blown.&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Since everything in Python is an object, you can treat them as such. This means you can store the types themselves in a list.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;my_types&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;It turns out this is really useful when writing scripts to parse a text file.
Let's say I'm writing a script to parse the CSV file below. (In reality,
I should just use the &lt;a href="http://pandas.pydata.org/"&gt;pandas&lt;/a&gt; library.)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;Bob, Jones, 26, 184.2
Thomas, Apple, 19, 155.9
Jake, Wilson, 31, 172.2
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The parser script can store the types of each field in a list,
and utilize it to convert each field value to its appropriate type
with a simple generator expression:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;field_names&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;first&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;last&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;age&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;weight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;field_types&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;float&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;parse_line&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    Parse a single line and return a dictionary.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;field_values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ft&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fv&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;ft&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;fv&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;field_names&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;field_types&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;field_values&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;parse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    Parse all of the lines in the file.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;parse_line&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;l&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;To summarize, storing types in a list is really useful for writing concise scripts to parse text.&lt;/p&gt;</summary><category term="python"></category></entry><entry><title>Wrapping Python Dictionaries</title><link href="https://leemendelowitz.github.io/blog/wrapping-python-dictionaries.html" rel="alternate"></link><updated>2013-10-02T17:45:00+02:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2013-10-02:blog/wrapping-python-dictionaries.html</id><summary type="html">&lt;p&gt;Very frequently when I'm programming in python, I write functions that return a
dictionary with string keys.&lt;/p&gt;
&lt;p&gt;When developing or debugging such programs in IPython, it's pretty tedious to
inspect these dictionaries. First, you need to get a list of keys. Then, to see a particular
value in the dictionary &lt;code&gt;d&lt;/code&gt;, you need to type out &lt;code&gt;d['key']&lt;/code&gt;. It gets tedious
after a while.&lt;/p&gt;
&lt;p&gt;IPython has really useful object introspection and tab-completion features, but they aren't
useful in this situation. A simple hack is to implement a class which sets the instance attributes
using the key/value pairs stored in a dictionary.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DictWrap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    Class to wrap a python dictionary.&lt;/span&gt;
&lt;span class="sd"&gt;    This helps with tab completion for object introspection in IPython&lt;/span&gt;

&lt;span class="sd"&gt;        myD = {&amp;#39;one&amp;#39; : 1, &amp;#39;two&amp;#39; : 2}&lt;/span&gt;
&lt;span class="sd"&gt;        d = DictWrap(myD)&lt;/span&gt;

&lt;span class="sd"&gt;    Now in IPython you can inspect and autocomplete with d.o&amp;lt;TAB&amp;gt;&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;        Construct a DictWrap instance from a python dictionary d&lt;/span&gt;
&lt;span class="sd"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iteritems&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
            &lt;span class="nb"&gt;setattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now in the IPython shell, you can easily inspect your dictionaries using tab-completion!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;myD&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;one&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;two&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;three&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;DictWrap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;myD&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;.&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;TAB&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="c"&gt;# prints d.one d.two d.three&lt;/span&gt;
&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;TAB&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="c"&gt;# prints d.two d.three&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</summary><category term="python"></category><category term="ipython"></category></entry><entry><title>Start Me Up!</title><link href="https://leemendelowitz.github.io/blog/start-me-up.html" rel="alternate"></link><updated>2013-10-02T07:35:00+02:00</updated><author><name>Lee Mendelowitz</name></author><id>tag:leemendelowitz.github.io,2013-10-02:blog/start-me-up.html</id><summary type="html">&lt;!--- #Status: draft --&gt;

&lt;p&gt;Welcome to the blog!&lt;/p&gt;
&lt;p&gt;After a nice cup of coffee this morning, I impulsively created this blog because I don't
have a good way of storing programming notes, complete with syntax
highlighting. I have been using Google Drive, which doesn't really cut it.
I also thought it would be fun to learn
how to publish a blog using &lt;a href="http://docs.getpelican.com/"&gt;Pelican&lt;/a&gt; + GitHub, so there's
also that. Checkout the
&lt;a href="https://github.com/LeeMendelowitz/blog"&gt;GitHub repo&lt;/a&gt;
for this blog! I just followed the &lt;code&gt;pelican-quickstart&lt;/code&gt;, modified the Makefile, and was up and running.&lt;/p&gt;
&lt;p&gt;I'm currently taking the Coursera course &lt;a href="https://class.coursera.org/compdata-003/class"&gt;Computing for Data Science&lt;/a&gt; by Roger Peng, so I'll probably start off with some simple notes on R programming.&lt;/p&gt;</summary></entry></feed>